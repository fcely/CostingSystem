<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WF-INTACCT</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>

    <!--Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>

 

    <style>
/* Q&A Modal Styles */
.qa-modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(5px);
}

.qa-modal-content {
    background-color: white;
    margin: 5% auto;
    border-radius: 15px;
    width: 90%;
    max-width: 800px;
    height: 80vh;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    animation: modalSlideIn 0.3s ease-out;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-50px) scale(0.95);
    }
    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.qa-modal-header {
    background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
    color: white;
    padding: 20px;
    border-radius: 15px 15px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.qa-modal-header h3 {
    margin: 0;
    font-size: 1.4em;
    font-weight: 600;
}

.qa-close {
    background: none;
    border: none;
    color: white;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.qa-close:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.1);
}

.qa-chat-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: #f8f9fa;
}

.qa-user-info {
    padding: 15px 20px;
    background: white;
    border-bottom: 1px solid #e9ecef;
    display: flex;
    align-items: center;
    gap: 10px;
}

.qa-user-avatar {
    width: 35px;
    height: 35px;
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 14px;
}

.qa-user-input {
    border: 1px solid #ddd;
    padding: 8px 12px;
    border-radius: 20px;
    outline: none;
    font-size: 14px;
    transition: border-color 0.3s ease;
}

.qa-user-input:focus {
    border-color: #3498db;
}

#qaMessages {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    background: #f8f9fa;
}

.qa-input-container {
    background: white;
    padding: 20px;
    border-top: 1px solid #e9ecef;
    border-radius: 0 0 15px 15px;
}

.qa-type-selector {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    justify-content: center;
}

.qa-type-btn {
    padding: 8px 16px;
    border: 2px solid #e9ecef;
    background: white;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 500;
    font-size: 13px;
    position: relative;
}

.qa-type-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);}

.qa-type-btn.active {
    background: #3498db;
    border-color: #3498db;
    color: white;
}

.qa-input-row {
    display: flex;
    gap: 10px;
    align-items: flex-end;
}

.qa-input {
    flex: 1;
    padding: 12px 16px;
    border: 2px solid #e9ecef;
    border-radius: 25px;
    outline: none;
    font-size: 14px;
    transition: border-color 0.3s ease;
    resize: none;
    min-height: 44px;
    max-height: 120px;
}

.qa-input:focus {
    border-color: #3498db;
}

.qa-send-btn {
    padding: 12px 24px;
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    border: none;
    border-radius: 25px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
    white-space: nowrap;
}

.qa-send-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
}

/* Message Styles */
.qa-message {
    margin-bottom: 15px;
    padding: 12px 16px;
    border-radius: 12px;
    max-width: 80%;
    word-wrap: break-word;
    position: relative;
    animation: messageSlideIn 0.3s ease-out;
    border: 2px solid transparent;
}

@keyframes messageSlideIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.qa-message.user {
    background: linear-gradient(135deg, #3498db, #2980b9);
    color: white;
    margin-left: auto;
    border-bottom-right-radius: 4px;
}

.qa-message.other {
    background: white;
    border: 1px solid #e9ecef;
    margin-right: auto;
    border-bottom-left-radius: 4px;
}

.qa-message.note {
    background: linear-gradient(135deg, #e3f2fd, #bbdefb);
    border-left: 4px solid #2196f3;
    color: #0d47a1;
}

.qa-message.note.user {
    background: linear-gradient(135deg, #2196f3, #1976d2);
    color: white;
    border-left: 4px solid #0d47a1;
}

.qa-message.note .qa-message-type {
    background: rgba(33, 150, 243, 0.2);
    color: #1976d2;
}

.qa-message.question .qa-message-type {
    background: rgba(255, 152, 0, 0.2);
    color: #f57c00;
}

.qa-message.answer .qa-message-type {
    background: rgba(76, 175, 80, 0.2);
    color: #388e3c;
}

.qa-message.user .qa-message-type {
    background: rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.9);
}

.qa-message.question {
    background: linear-gradient(135deg, #fff3e0, #ffe0b2);
    border-left: 4px solid #ff9800;
    color: #e65100;
    position: relative;
}

.qa-message.question.user {
    background: linear-gradient(135deg, #ff9800, #f57c00);
    color: white;
    border-left: 4px solid #e65100;
}

/* Answer Messages - Green Theme */
.qa-message.answer {
    background: linear-gradient(135deg, #e8f5e8, #c8e6c9);
    border-left: 4px solid #4caf50;
    color: #1b5e20;
}

.qa-message.answer.user {
    background: linear-gradient(135deg, #4caf50, #388e3c);
    color: white;
    border-left: 4px solid #1b5e20;
}

.qa-message-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 5px;
    font-size: 12px;
    opacity: 0.8;
}

.qa-message-user {
    font-weight: bold;
}

/* Enhanced message type badges */
.qa-message-type {
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 9px;
    text-transform: uppercase;
    font-weight: bold;
    letter-spacing: 0.5px;
}

.qa-message-content {
    font-size: 14px;
    line-height: 1.4;
}
/* Special styling for answered questions */
.qa-message.question.answered {
    background: linear-gradient(135deg, #f1f8e9, #dcedc8);
    border-left: 4px solid #8bc34a;
    color: #33691e;
}

.qa-message.question.answered::before {
    content: "âœ“ ANSWERED";
    position: absolute;
    top: -8px;
    right: 8px;
    background: #4caf50;
    color: white;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 9px;
    font-weight: bold;
    letter-spacing: 0.5px;
}
/* Thread styling for replies */
.qa-thread {
    border-left: 3px solid #4caf50;
    margin-left: 20px;
    padding-left: 15px;
    margin-top: 10px;
    background: rgba(76, 175, 80, 0.05);
    border-radius: 0 8px 8px 0;
    padding-top: 10px;
    padding-bottom: 5px;
}

.qa-thread .qa-message {
    margin-bottom: 8px;
    font-size: 13px;
    max-width: 95%;
}

.qa-thread-indicator {
    font-size: 10px;
    color: #4caf50;
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    gap: 5px;
    font-weight: bold;
}

.qa-thread-indicator::before {
    content: "â†³";
    font-weight: bold;
    font-size: 12px;
}
/* Enhanced QA Icon Styles with Better Pending Indicator */
.qa-icon {
    position: absolute;
    right: 60px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: all 0.3s ease;
    z-index: 10;
    background: rgba(255, 255, 255, 0.1);
}

.qa-icon:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateY(-50%) scale(1.1);
}

/* Improved pending questions indicator */
.qa-icon.has-pending {
    position: absolute;
    animation: iconPulse 2s infinite;
}

.qa-icon.has-pending::after {
    content: attr(data-count);
    position: absolute;
    top: -2px;
    right: -2px;
    background: linear-gradient(135deg, #e74c3c, #c0392b);
    color: white;
    border-radius: 50%;
    min-width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 11px;
    font-weight: bold;
    border: 2px solid white;
    box-shadow: 0 2px 8px rgba(231, 76, 60, 0.4);
    animation: badgePulse 2s infinite;
}

@keyframes iconPulse {
    0%, 100% { 
        box-shadow: 0 0 0 0 rgba(231, 76, 60, 0.4);
    }
    50% { 
        box-shadow: 0 0 0 8px rgba(231, 76, 60, 0);
    }
}

@keyframes badgePulse {
    0%, 100% { 
        transform: scale(1);
    }
    50% { 
        transform: scale(1.1);
    }
}

/* Summary Section Styles */
.qa-summary-section {
    background: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.qa-summary-title {
    text-align: center;
    font-size: 18px;
    font-weight: bold;
    color: #2c3e50;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #3498db;
}

.qa-section-group {
    margin-bottom: 25px;
    border: 1px solid #e9ecef;
    border-radius: 8px;
    overflow: hidden;
}

.qa-section-group h4 {
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    margin: 0;
    padding: 12px 15px;
    font-size: 14px;
    color: #2c3e50;
    border-bottom: 1px solid #e9ecef;
}

.qa-question-item {
    padding: 12px 15px;
    border-bottom: 1px solid #f1f2f6;
    transition: all 0.3s ease;
    border-left: 4px solid transparent;
}

.qa-question-item:last-child {
    border-bottom: none;
}

.qa-question-item:hover {
    background-color: #f8f9fa;
    transform: translateX(2px);
}

.qa-question-item:not(.answered) {
    background: linear-gradient(135deg, #fff3e0, #ffeaa7);
    border-left-color: #ff9800;
}

.qa-question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
    font-size: 12px;
}

.qa-question-user {
    font-weight: bold;
    color: #2c3e50;
}

.qa-question-status {
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 10px;
    text-transform: uppercase;
    font-weight: bold;
}

.qa-question-status.pending {
    background: #fff3cd;
    color: #856404;
}

.qa-question-status.answered {
    background: #d1ecf1;
    color: #0c5460;
}

.qa-question-time {
    color: #6c757d;
    font-size: 11px;
}

.qa-question-text {
    color: #495057;
    font-size: 13px;
    line-height: 1.4;
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .qa-modal-content {
        margin: 0;
        width: 100%;
        height: 100vh;
        border-radius: 0;
    }
    
    .qa-modal-header {
        border-radius: 0;
    }
    
    .qa-input-container {
        border-radius: 0;
    }
    
    .qa-icon {
        right: 50px;
        font-size: 18px;
        padding: 6px;
    }
    
    .qa-type-selector {
        flex-wrap: wrap;
        gap: 8px;
    }
    
    .qa-type-btn {
        padding: 6px 12px;
        font-size: 12px;
    }

     .qa-icon.has-pending::after {
        min-width: 18px;
        height: 18px;
        font-size: 10px;
        top: -1px;
        right: -1px;
    }
    
    .qa-message {
        max-width: 90%;
        padding: 10px 12px;
    }
    
    .qa-thread {
        margin-left: 15px;
        padding-left: 10px;
    }
}

.qa-type-btn[data-type="note"] {
    border-color: #2196f3;
    color: #2196f3;
}

.qa-type-btn[data-type="note"].active {
    background: linear-gradient(135deg, #2196f3, #1976d2);
    border-color: #2196f3;
    color: white;
}

.qa-type-btn[data-type="question"] {
    border-color: #ff9800;
    color: #ff9800;
}

.qa-type-btn[data-type="question"].active {
    background: linear-gradient(135deg, #ff9800, #f57c00);
    border-color: #ff9800;
    color: white;
}

.qa-type-btn[data-type="answer"] {
    border-color: #4caf50;
    color: #4caf50;
}

.qa-type-btn[data-type="answer"].active {
    background: linear-gradient(135deg, #4caf50, #388e3c);
    border-color: #4caf50;
    color: white;
}

/*Historical Context*/
    .historical-timeline {
      position: relative;
      padding: 20px 0;
    }

    .historical-timeline::before {
      content: '';
      position: absolute;
      width: 4px;
      background: linear-gradient(to bottom, #667eea, #764ba2);
      top: 0;
      bottom: 0;
      left: 120px;
      border-radius: 2px;
      box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
    }

    .timeline-item {
      position: relative;
      margin: 25px 0;
      padding-left: 90px;
      opacity: 0;
      transform: translateX(-30px);
      animation: slideInLeft 0.6s ease forwards;
    }

    .timeline-item:nth-child(odd) {
      animation-delay: calc(var(--item-index, 0) * 0.1s);
    }

    .timeline-item:nth-child(even) {
      animation-delay: calc(var(--item-index, 0) * 0.1s + 0.05s);
    }

    .year-badge {
      position: absolute;
      left: -105px;
      top:20px;
      transform: translateY(-50%);
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 12px 16px;
      border-radius: 25px;
      font-weight: 700;
      font-size: 14px;
      min-width: 80px;
      text-align: center;
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
      border: 3px solid white;
      z-index: 2;
      transition: all 0.3s ease;
    }

    .year-badge:hover {
      transform: translateY(-50%) scale(1.05);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: 4px solid white;
      border-radius: 50%;
      left: 105px;
      top:20px;
      margin-left: 5px;
      transform: translateY(-50%);
      box-shadow: 0 0 15px rgba(102, 126, 234, 0.4);
      z-index: 3;
      transition: all 0.3s ease;
    }

    .timeline-item:hover::before {
      transform: translateY(-50%) scale(1.2);
      box-shadow: 0 0 25px rgba(102, 126, 234, 0.6);
    }

    .content-box {
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
      border: 1px solid rgba(102, 126, 234, 0.1);
      position: relative;
      transition: all 0.3s ease;
      margin-left: 15px;
    }

    .content-box::before {
      content: '';
      position: absolute;
      
      top: 0px;
      width: 0;
      height: 0;
      border: 15px solid transparent;
      border-right-color: white;
      z-index: 1;
    }

    .content-box:hover {
      transform: translateY(-3px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
      border-color: rgba(102, 126, 234, 0.3);
    }

    .content-text {
      color: #2c3e50;
      font-size: 16px;
      line-height: 1.6;
      margin: 0;
      font-weight: 400;
    }

    .milestone-indicator {
      position: absolute;
      top: 0px;
      right: 0px;
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: white;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      opacity: 0;
      transform: scale(0);
      transition: all 0.3s ease;
      z-index: 7;
    }

    .timeline-item.milestone .milestone-indicator {
      opacity: 1;
      transform: scale(1);
    }

    .timeline-item.milestone .year-badge {
      background: linear-gradient(135deg, #f39c12, #e67e22);
    }

    .timeline-item.milestone::before {
      background: linear-gradient(135deg, #f39c12, #e67e22);
    }

    @keyframes slideInLeft {
      from {
        opacity: 0;
        transform: translateX(-30px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .section-content.expanded .timeline-item {
      animation-play-state: running;
    }

    .section-content.collapsed .timeline-item {
      animation-play-state: paused;
      opacity: 0;
      transform: translateX(-30px);
    }

    @media (max-width: 768px) {
      .section {
        margin: 20px 10px;
        border-radius: 15px;
      }

      .section-header {
        padding: 20px;
      }

      .section-header h2 {
        font-size: 24px;
      }

      .historical-timeline::before {
        left: 52px;
      }

      .timeline-item {
        padding-left: 70px;
      }

      .year-badge {
        left: -15px;
        min-width: 70px;
        padding: 10px 12px;
        font-size: 12px;
      }

      .timeline-item::before {
        left: 21px;
      }

      .content-box {
        margin-left: 15px;
        padding: 20px;
      }

      .content-box::before {
        left: -12px;
        border-width: 12px;
      }

      .section-content.expanded {
        padding: 20px;
      }
    }
 




/*Meeting Goals Enhanced*/

.meeting-goals-container {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    padding: 30px;
    border-radius: 15px;
    margin: 20px 0;
}

.goals-item {
    display: flex;
    align-items: center;
    margin: 20px 0;
    opacity: 0;
    transform: translateX(-30px);
    animation: slideInGoal 0.6s ease forwards;
    transition: all 0.3s ease;
}

.goals-item:nth-child(1) { animation-delay: 0.1s; }
.goals-item:nth-child(2) { animation-delay: 0.2s; }
.goals-item:nth-child(3) { animation-delay: 0.3s; }
.goals-item:nth-child(4) { animation-delay: 0.4s; }

.goals-item:hover {
    transform: translateX(10px);
}

.goals-number {
    width: 45px;
    height: 45px;
    background: linear-gradient(135deg, #00ff73, #00cc5a);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 20px;
    color: white;
    font-weight: 700;
    font-size: 18px;
    box-shadow: 0 6px 20px rgba(0, 255, 115, 0.3);
    border: 3px solid white;
    transition: all 0.3s ease;
    position: relative;
    z-index: 2;
}

.goals-number:hover {
    transform: scale(1.1);
    box-shadow: 0 8px 25px rgba(0, 255, 115, 0.4);
}

.goals-text {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 12px;
    padding: 18px 25px;
    color: #2c3e50;
    min-width: 300px;
    flex: 1;
    font-weight: 500;
    font-size: 16px;
    line-height: 1.4;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
    position: relative;
}

.goals-text::before {
    content: '';
    position: absolute;
    left: -12px;
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 0;
    border: 12px solid transparent;
    border-right-color: rgba(255, 255, 255, 0.95);
    z-index: 1;
}

.goals-text:hover {
    background: rgba(255, 255, 255, 1);
    transform: translateY(-3px);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
    border-color: rgba(0, 255, 115, 0.3);
}

@keyframes slideInGoal {
    from {
        opacity: 0;
        transform: translateX(-30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.section-content.expanded .goals-item {
    animation-play-state: running;
}

.section-content.collapsed .goals-item {
    animation-play-state: paused;
    opacity: 0;
    transform: translateX(-30px);
}

@media (max-width: 768px) {
    .meeting-goals-container {
        padding: 20px;
    }
    
    .goals-number {
        width: 40px;
        height: 40px;
        font-size: 16px;
        margin-right: 15px;
    }
    
    .goals-text {
        padding: 15px 20px;
        min-width: 250px;
        font-size: 15px;
    }
}

/*end meeting goals enhanced*/

        /*DiseÃ±o*/

        .list-item {
            position: absolute;
            right: 250px;
            display: none; /* Oculto por defecto */
            background: linear-gradient(135deg, #f9f871 0%, #e6d435 100%);
            border: 2px solid #d4b429;
            padding: 10px;
            border-radius: 16px;
            width: 360px;
        }
        .list-item ul{
            margin: 0px;
        }
        .list-item h4{
            margin: 8px 0px;
        }
        .brand-img{
            right: 110px;
            position: absolute;
            top: 70px;
        }
        .brand-img img{
            margin-right: 10px;
        }

        .erp-module {
            cursor: pointer;
            padding: 10px;
            margin: 5px;
            background: #cce;
            display: inline-block;
        }

        /*DiseÃ±o*/

        /*timeline 2 */
 .prjtimeline-container {
      max-width: 800px;
      width: 100%;
      position: relative;
    }

    .prjtimeline-header {
      text-align: center;
      margin-bottom: 50px;
    }

    .prjtimeline-title {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      color: #2c3e50;
      padding: 20px 40px;
      border-radius: 15px;
      font-size: 28px;
      font-weight: 600;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .prjtimeline {
      position: relative;
      padding: 40px 20px;
   
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
 

    }


    /* Central timeline line */
    .prjtimeline::before {
      content: '';
      position: absolute;
      width: 4px;
      background: linear-gradient(to bottom, #3498db, #9b59b6);
      top: 0;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 2px;
      box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
    }

    .prjtimeline-item {
      position: relative;
      margin: 30px 0;
      width: 45%;
      opacity: 0;
      animation: fadeInUp 0.6s ease forwards;
    }

    .prjtimeline-item:nth-child(odd) {
      left: 0;
      animation-delay: calc(var(--item-index) * 0.1s);
    }

    .prjtimeline-item:nth-child(even) {
      left: 55%;
      animation-delay: calc(var(--item-index) * 0.1s);
    }

    .prjtimeline-content {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      position: relative;
      transition: all 0.3s ease;
    }

    .prjtimeline-content:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
    }

    .prjtimeline-item.current .prjtimeline-content {
      background: linear-gradient(135deg, #a8e6cf, #dcedc1);
      border: 2px solid #27ae60;
      box-shadow: 0 8px 32px rgba(39, 174, 96, 0.2);
    }

    .prjtimeline-item.completed .prjtimeline-content {
      background: rgba(255, 255, 255, 0.8);
      opacity: 0.9;
    }

    .prjtimeline-item.future .prjtimeline-content {
      background: rgba(255, 255, 255, 0.7);
      border: 1px dashed rgba(155, 89, 182, 0.5);
    }

    /* Timeline dots */
    .prjtimeline-item::before {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, #3498db, #9b59b6);
      border: 4px solid white;
      border-radius: 50%;
      top: 35px;
      box-shadow: 0 0 15px rgba(52, 152, 219, 0.4);
      z-index: 2;
      transition: all 0.3s ease;
    }

    .prjtimeline-item:nth-child(odd)::before {
      right: -14px;
    }

    .prjtimeline-item:nth-child(even)::before {
      left: -14px;
    }

    .prjtimeline-item.current::before {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
      width: 24px;
      height: 24px;
      box-shadow: 0 0 20px rgba(39, 174, 96, 0.6);
      animation: pulse 2s infinite;
    }

    .prjtimeline-item.current:nth-child(odd)::before {
      right: -16px;
    }

    .prjtimeline-item.current:nth-child(even)::before {
      left: -16px;
    }

    .prjtimeline-item.completed::before {
      background: linear-gradient(135deg, #95a5a6, #bdc3c7);
    }

    .prjtimeline-item.future::before {
      background: linear-gradient(135deg, #e74c3c, #f39c12);
      opacity: 0.7;
    }

    /* Connection arrows */
    .prjtimeline-item:nth-child(odd) .prjtimeline-content::after {
      content: '';
      position: absolute;
      top: 35px;
      right: -15px;
      width: 0;
      height: 0;
      border: 15px solid transparent;
      border-left-color: rgba(255, 255, 255, 0.95);
      z-index: 1;
    }

    .prjtimeline-item:nth-child(even) .prjtimeline-content::after {
      content: '';
      position: absolute;
      top: 35px;
      left: -15px;
      width: 0;
      height: 0;
      border: 15px solid transparent;
      border-right-color: rgba(255, 255, 255, 0.95);
      z-index: 1;
    }

    .prjtimeline-item.current:nth-child(odd) .prjtimeline-content::after {
      border-left-color: #a8e6cf;
    }

    .prjtimeline-item.current:nth-child(even) .prjtimeline-content::after {
      border-right-color: #a8e6cf;
    }

    .date {
      font-weight: 700;
      color: #2c3e50;
      font-size: 16px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .date::before {
      content: 'ðŸ“…';
      font-size: 14px;
    }

    .description {
      color: #34495e;
      font-size: 15px;
      line-height: 1.6;
      font-weight: 400;
    }

    .status-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-completed {
      background: #27ae60;
      color: white;
    }

    .status-current {
      background: #f39c12;
      color: white;
      animation: pulse 2s infinite;
    }

    .status-future {
      background: #e74c3c;
      color: white;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    @media (max-width: 768px) {
      body {
        padding: 20px 15px;
      }
      
      .prjtimeline::before {
        left: 30px;
      }
      
      .prjtimeline-item,
      .prjtimeline-item:nth-child(odd),
      .prjtimeline-item:nth-child(even) {
        left: 0;
        width: calc(100% - 60px);
        margin-left: 60px;
      }
      
      .prjtimeline-item::before,
      .prjtimeline-item:nth-child(odd)::before,
      .prjtimeline-item:nth-child(even)::before,
      .prjtimeline-item.current:nth-child(odd)::before,
      .prjtimeline-item.current:nth-child(even)::before {
        left: -44px;
        right: auto;
      }
      
      .prjtimeline-content::after,
      .prjtimeline-item:nth-child(odd) .prjtimeline-content::after,
      .prjtimeline-item:nth-child(even) .prjtimeline-content::after {
        left: -15px;
        right: auto;
        border: 15px solid transparent;
        border-right-color: rgba(255, 255, 255, 0.95);
        border-left-color: transparent;
      }
      
      .prjtimeline-item.current .prjtimeline-content::after {
        border-right-color: #a8e6cf;
      }
      
      .prjtimeline-title {
        font-size: 24px;
        padding: 15px 25px;
      }
    }

        /*timeline*/

         .timeline-container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .timeline-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 30px;
            animation: fadeInUp 0.6s ease-out;
            animation-fill-mode: both;
        }

        .timeline-item:nth-child(1) { animation-delay: 0.1s; }
        .timeline-item:nth-child(2) { animation-delay: 0.2s; }
        .timeline-item:nth-child(3) { animation-delay: 0.3s; }
        .timeline-item:nth-child(4) { animation-delay: 0.4s; }
        .timeline-item:nth-child(5) { animation-delay: 0.5s; }
        .timeline-item:nth-child(6) { animation-delay: 0.6s; }
        .timeline-item:nth-child(7) { animation-delay: 0.7s; }
        .timeline-item:nth-child(8) { animation-delay: 0.8s; }

        .year-badge {
            background: linear-gradient(45deg, #4a90e2, #357abd);
            color: white;
            padding: 12px 20px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 14px;
            min-width: 60px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(74, 144, 226, 0.3);
            position: relative;
            z-index: 2;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .year-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
        }

        .content-box {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            padding: 20px 24px;
            margin-left: 24px;
            flex: 1;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        .content-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .content-box::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 20px;
            width: 0;
            height: 0;
            border-top: 8px solid transparent;
            border-bottom: 8px solid transparent;
            border-right: 8px solid rgba(255, 255, 255, 0.95);
        }

        .content-text {
            color: #2c3e50;
            line-height: 1.6;
            font-size: 15px;
            margin: 0;
        }

        .timeline-line {
            position: absolute;
            left: 50px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, 
                rgba(255, 255, 255, 0.8) 0%, 
                rgba(255, 255, 255, 0.4) 50%, 
                rgba(255, 255, 255, 0.2) 100%);
            z-index: 1;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .title {
            text-align: center;
            color: white;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 50px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            animation: fadeInDown 0.8s ease-out;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 768px) {
            .timeline-container {
                padding: 0 10px;
            }
            
            .year-badge {
                min-width: 50px;
                padding: 10px 16px;
                font-size: 13px;
            }
            
            .content-box {
                margin-left: 16px;
                padding: 16px 20px;
            }
            
            .title {
                font-size: 2rem;
                margin-bottom: 30px;
            }
        }

        /*end time line*/

        
         .erp-integration-container {
            position: relative;
            width: 100%;
            height: 700px;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .erp-module {
            position: absolute;
            border-radius: 25px;
            padding: 8px 16px;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            font-size: 11px;
            min-width: 40px;
        }
        
        .erp-module:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        
        .wf-erp-module {
            background: linear-gradient(135deg, #f9f871 0%, #e6d435 100%);
            border: 2px solid #d4b429;
            color: #333;
        }
        
        .intacct-erp-module {
            background: linear-gradient(135deg, #b3d9ff 0%, #7fc4ff 100%);
            border: 2px solid #5ba3d0;
            color: #333;
        }
        
        .system-erp-module {
            border: 2px solid #2c5aa0;
        }
        
        .central-erp-hub {
            border-width: 3px !important;
        }
        
        .erp-connection-line {
            position: absolute;
            height: 3px;
            transform-origin: left center;
            z-index: 1;
        }
        
        .erp-internal-flow {
            background: #2ecc71;
        }
        
        .erp-data-flow {
            background: #e74c3c;
            height: 4px;
        }
        
        .erp-shared-connection {
            background: #666;
            height: 2px;
            opacity: 0.7;
        }
        
        .erp-bi-flow {
            background: #27ae60;
        }
        
        .erp-arrow {
            position: absolute;
            width: 0;
            height: 0;
            z-index: 2;
        }
        
        .erp-arrow-green {
            border-left: 8px solid #2ecc71;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
        }
        
        .erp-flow-label {
            position: absolute;
            font-size: 10px;
            font-weight: bold;
            color: #e74c3c;
            background: rgba(255,255,255,0.9);
            padding: 2px 6px;
            border-radius: 4px;
            z-index: 3;
        }
        
        /* ERP Module Positioning - Desktop */
        .erp-oe { top: 60px; left: 150px; width: 40px }
        .erp-bom { top: 110px; left:50px; width: 40px }
        .erp-pop { top: 160px; left: 50px; width: 40px }
        .erp-im { top: 135px; left: 150px; width: 40px}
        .erp-po-lc { top: 210px; left: 150px; width: 40px }
        
        .erp-gl { top: 135px; left: 300px; width: 40px }
      
        .erp-ar { top: 60px; left: 260px; width: 40px}
        .erp-ap { top: 210px; left: 260px; width: 40px}

        .erp-cm { top: 60px; left: 400px; width: 40px}
        .erp-ad { top: 110px; left: 400px; width: 40px}
        .erp-pr { top: 160px; left: 400px; width: 40px}
        .erp-bb { top: 210px; left: 400px; width: 40px}
        
        .erp-master-tables { 
            top: 320px; 
            left:100px; 
            width: 140px; 
            height: 60px; 
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .erp-budget-system { 
            top: 320px; 
            left: 300px; 
            width: 140px; 
            height: 60px; 
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .erp-vu-warehouse {
            top: 420px;
            left: 50px;
            width: 450px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 14px;
        }
        
        .erp-reports-section {
            background: #ffffff;
            border: 2px solid #dee2e6;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .erp-reports-title {
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }
        
        .erp-reports-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        .erp-report-category h4 {
            color: #2c3e50;
            margin-bottom: 8px;
            font-size: 13px;
        }
        
        .erp-report-category ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .erp-report-category li {
            font-size: 11px;
            color: #555;
            margin-bottom: 4px;
            padding-left: 12px;
            position: relative;
        }
        
        .erp-report-category li:before {
            content: "-";
            color: #3498db;
            font-weight: bold;
            position: absolute;
            left: 0;
        }
        
        .erp-legend {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(248, 249, 250, 0.95);
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 15px;
            min-width: 180px;
            backdrop-filter: blur(5px);
        }
        
        .erp-legend h4 {
            margin: 0 0 12px 0;
            color: #2c3e50;
            font-size: 12px;
        }
        
        .erp-legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
            font-size: 10px;
            color: #555;
        }
        
        .erp-legend-color {
            width: 18px;
            height: 10px;
            border-radius: 3px;
            margin-right: 8px;
            border: 1px solid rgba(0,0,0,0.2);
        }
        
        .erp-legend-line {
            width: 18px;
            height: 3px;
            margin-right: 8px;
            border-radius: 2px;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 10px;
            background-image: url("https://kendalfloral.com/wp-content/uploads/2020/02/Kendal2235-copy-1.jpg");
            background-color: #d8eec9;
            background-attachment: fixed;
            background-size: cover;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .content {
            padding: 20px;
        }
        
        .section {
            margin-bottom: 10px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .section-header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);;
            color: white;
            padding: 5px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .section-header:hover {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            transform: translateY(-2px);
        }
        
        .section-header h2 {
            margin: 0;
            font-size: 1.8em;
            font-weight: 400;
            padding-right: 40px;
        }
        
        .section-content {
            padding: 25px;
            background: #f8f9fa;
            border-top: 3px solid #3498db;
        }
        
        .process-step {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .journal-entries {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border: 1px solid #3498db;
        }
        
        .journal-entries h4 {
            color: #2c3e50;
            margin-top: 0;
            font-size: 1.1em;
        }
        
        .entry-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #bdc3c7;
            flex-wrap: wrap;
        }
        
        .entry-item:last-child {
            border-bottom: none;
        }
        
        .debit {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .credit {
            color: #27ae60;
            font-weight: bold;
        }
        
        .diagram-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .diagram-title {
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .toggle-btn {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .toggle-btn.rotated {
            transform: translateY(-50%) rotate(180deg);
        }
        
        .collapsed {
            display: none;
        }
        
        .key-benefits {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #27ae60;
        }
        
        .key-benefits h4 {
            color: #27ae60;
            margin-top: 0;
        }
        
        .future-enhancements {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }
        
        .future-enhancements h4 {
            color: #856404;
            margin-top: 0;
        }

        /* Agenda Table Styles */
        .agenda-container {
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .agenda-table {
            width: 100%;
            min-width: 800px;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .agenda-table th {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
        }
        
        .agenda-table td {
            padding: 12px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
            font-size: 12px;
        }
        
        .agenda-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .day-header td {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            font-size: 14px;
        }
        
        .day-header:hover td {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
        }
        
        .break-row td {
            background-color: #f1f2f6;
            font-style: italic;
            color: #7f8c8d;
        }
        
        .break-row:hover td {
            background-color: #f1f2f6;
        }
        
        .agenda-table td:first-child {
            font-weight: 600;
            color: #2c3e50;
            white-space: nowrap;
        }
        
        .agenda-table td:nth-child(2) {
            font-weight: 600;
            color: #e74c3c;
            white-space: nowrap;
        }
        
        .agenda-table td:nth-child(3) {
            font-weight: 600;
            color: #27ae60;
        }
        
        .agenda-table td:last-child {
            color: #8e44ad;
            font-weight: 500;
        }

        /* Mobile Responsive Styles */
        @media (max-width: 768px) {
            body {
                padding: 5px;
                background-attachment: local;
            }
            
            .header h1 {
                font-size: 1.8em;
                line-height: 1.2;
            }
            
            .header p {
                font-size: 0.9em;
            }
            
            .content {
                padding: 15px;
            }
            
            .section-header {
                padding: 15px;
            }
            
            .section-header h2 {
                font-size: 1.4em;
                padding-right: 35px;
            }
            
            .section-content {
                padding: 15px;
            }
            
            .toggle-btn {
                right: 15px;
                font-size: 1.2em;
            }
            
            /* ERP Integration Mobile Layout */
            .erp-integration-container {
                height: 800px;
                padding: 15px;
            }
            
            .erp-module {
                font-size: 10px;
                padding: 6px 12px;
            }
            
            /* Mobile positioning for ERP modules */
            .erp-oe { top: 80px; left: 20px; width: 45px }
            .erp-bom { top: 140px; left: 20px; width: 45px }
            .erp-pop { top: 200px; left: 20px; width: 45px }
            .erp-im { top: 160px; left: 80px; width: 45px}
            .erp-po-lc { top: 260px; left: 20px; width: 55px }
            
            .erp-gl { top: 160px; left: 140px; width: 45px }
            .erp-ar { top: 80px; left: 140px; width: 45px}
            .erp-ap { top: 260px; left: 140px; width: 45px}

            .erp-cm { top: 80px; left: 200px; width: 45px}
            .erp-ad { top: 140px; left: 200px; width: 45px}
            .erp-pr { top: 200px; left: 200px; width: 45px}
            .erp-bb { top: 260px; left: 200px; width: 45px}
            
            .erp-master-tables { 
                top: 340px; 
                left: 20px; 
                width: 120px; 
                height: 70px; 
                font-size: 9px;
            }
            
            .erp-budget-system { 
                top: 340px; 
                left: 150px; 
                width: 120px; 
                height: 70px; 
                font-size: 9px;
            }
            
            .erp-vu-warehouse {
                top: 450px;
                left: 20px;
                width: 250px;
                height: 70px;
                font-size: 12px;
            }
            
            /* Adjust connection lines for mobile */
            .erp-connection-line {
                display: none;
            }
            
            .erp-arrow {
                display: none;
            }
            
            .erp-legend {
                position: relative;
                top: auto;
                right: auto;
                margin: 20px 0;
                min-width: auto;
                width: 100%;
            }
            
            .erp-reports-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            /* Table responsive styles */
            .agenda-table {
                min-width: 600px;
                font-size: 11px;
            }
            
            .agenda-table th {
                padding: 8px 6px;
                font-size: 11px;
            }
            
            .agenda-table td {
                padding: 8px 6px;
                font-size: 10px;
            }
            
            /* Journal entries mobile */
            .entry-item {
                flex-direction: column;
                gap: 5px;
            }
            
            .entry-item span:first-child {
                font-weight: bold;
            }
            
            /* Diagram container mobile */
            .diagram-container {
                padding: 15px 10px;
            }
            
            .diagram-title {
                font-size: 1em;
            }
            
            /* SVG responsive */
            svg {
                max-width: 100%;
                height: auto;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5em;
            }
            
            .section-header h2 {
                font-size: 1.2em;
            }
            
            .content {
                padding: 10px;
            }
            
            .section-content {
                padding: 10px;
            }
            
            .erp-integration-container {
                height: 600px;
                padding: 10px;
            }
            
            .erp-module {
                font-size: 8px;
                padding: 4px 8px;
            }
            
            /* Ultra-compact mobile positioning */
            .erp-oe { top: 60px; left: 15px; width: 35px }
            .erp-bom { top: 100px; left: 15px; width: 35px }
            .erp-pop { top: 140px; left: 15px; width: 35px }
            .erp-im { top: 120px; left: 60px; width: 35px}
            .erp-po-lc { top: 180px; left: 15px; width: 40px }
            
            .erp-gl { top: 120px; left: 105px; width: 35px }
            .erp-ar { top: 60px; left: 105px; width: 35px}
            .erp-ap { top: 180px; left: 105px; width: 35px}

            .erp-cm { top: 60px; left: 150px; width: 35px}
            .erp-ad { top: 100px; left: 150px; width: 35px}
            .erp-pr { top: 140px; left: 150px; width: 35px}
            .erp-bb { top: 180px; left: 150px; width: 35px}
            
            .erp-master-tables { 
                top: 240px; 
                left: 15px; 
                width: 80px; 
                height: 50px; 
                font-size: 7px;
            }
            
            .erp-budget-system { 
                top: 240px; 
                left: 105px; 
                width: 80px; 
                height: 50px; 
                font-size: 7px;
            }
            
            .erp-vu-warehouse {
                top: 320px;
                left: 15px;
                width: 170px;
                height: 50px;
                font-size: 10px;
            }
            
            .agenda-table {
                min-width: 500px;
                font-size: 9px;
            }
            
            .agenda-table th {
                padding: 6px 4px;
                font-size: 9px;
            }
            
            .agenda-table td {
                padding: 6px 4px;
                font-size: 8px;
            }
        }

    </style>

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Web Flowers - Intacct / Kendal Financial System</h1>
            <p>July 2025 - Carlsbad CA</p>
        </div>
        
        <div class="content">

                   <!-- Meeting Agenda Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('meeting-agenda')">
                    <h2>Meeting Agenda</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'meeting-agenda')" data-section="meeting-agenda">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-meeting-agenda">â–¼</button>
                </div>
                <div class="section-content collapsed" id="meeting-agenda" >
                    <div class="key-benefits">
                        <h4>Strategic Goal</h4>
                        <p>To integrate WebFlowers with Intacct to simplify cross-system operations, decommission Macola, ensure accurate cost and inventory control, and streamline processes for greater speed and efficiency - with an open scope that allows for flexibility and future enhancements. Aiming to have a modern Fully Integrated ERP</p>
                    </div>
                    
                    <div class="agenda-container">
                        <table class="agenda-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Time</th>
                                    <th>Session</th>
                                    <th>Description</th>
                                    <th>Action/Outcome Required</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="day-header">
                                    <td colspan="5"><strong>July 28, 2025 - Day 1: Foundation & Architecture</strong></td>
                                </tr>
                                <tr>
                                    <td>2025-07-28</td>
                                    <td>9:00 â€“ 9:30</td>
                                    <td>Welcome & Project Goal Reminder</td>
                                    <td>Welcome the team and remind everyone of the strategic goal: to replace Macola by leveraging WF and Intacct.</td>
                                    <td>Anna-David-Veronica-Paula</td>
                                </tr>
                                <tr>
                                    <td>2025-07-28</td>
                                    <td>9:30 â€“ 10:15</td>
                                    <td>Summary of What Has Been Built</td>
                                    <td>Overview of completed modules: landed cost, receiving, inventory, item setup, production, invoicing, month-end.</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-28</td>
                                    <td>10:15 â€“ 10:30</td>
                                    <td>1. General Architecture</td>
                                    <td>Present WF-Intacct interaction, system responsibilities, and the need for a perpetual inventory system.</td>
                                    <td></td>
                                </tr>
                                <tr class="break-row">
                                    <td>2025-07-28</td>
                                    <td>10:30 â€“ 1:00</td>
                                    <td>Break</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-28</td>
                                    <td>1:00 â€“ 3:00</td>
                                    <td>2. Master Tables</td>
                                    <td>Present built tables: costing groups, categories, Material cost types, locations, vendor config, Chart of Accounts(Workato-Keep updated), distribution file, inventory transactions</td>
                                    <td>Assign Owners</td>
                                </tr>
                                
                                <tr class="day-header">
                                    <td colspan="5"><strong>July 29, 2025 - Day 2: Core Modules</strong></td>
                                </tr>
                                <tr>
                                    <td>2025-07-29</td>
                                    <td>9:00 - 10:30</td>
                                    <td>3. Landed Cost Module</td>
                                    <td>Show functionality, improvements over Macola, future integration with trucking and cubes.</td>
                                    <td>David</td>
                                </tr>
                                <tr>
                                    <td>2025-07-29</td>
                                    <td>10:30 - 10:45</td>
                                    <td>4. PO Receiving</td>
                                    <td>Show PO receiving flow, edit lock mechanism; need for credit enhancements.</td>
                                    <td>Assign Owners</td>
                                </tr>
                                <tr class="break-row">
                                    <td>2025-07-29</td>
                                    <td>10:45 - 11:00</td>
                                    <td>Break</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-29</td>
                                    <td>11:00 â€“ 12:30</td>
                                    <td>5. Inventory Transactions</td>
                                    <td>Show transaction types (TA, transfer, adjust) and their impact on the distribution file. Inventory Location/CG Summary</td>
                                    <td></td>
                                </tr>
                                <tr class="break-row">
                                    <td>2025-07-29</td>
                                    <td>12:30 â€“ 1:30</td>
                                    <td>Lunch</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-29</td>
                                    <td>1:30 â€“ 3:00</td>
                                    <td>6. Production Reporting</td>
                                    <td>Dynamic BOMs, last-minute changes, disassembly use cases.</td>
                                    <td></td>
                                </tr>
                                
                                <tr class="day-header">
                                    <td colspan="5"><strong>July 30, 2025 - Day 3: Integration & Development</strong></td>
                                </tr>
                                <tr>
                                    <td>2025-07-30</td>
                                    <td>9:00 â€“ 9:30</td>
                                    <td>7. Invoicing</td>
                                    <td>Show invoice posting to distribution files and integration path to Intacct.</td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-30</td>
                                    <td>9:30 â€“ 11:00</td>
                                    <td>8. AP Integration</td>
                                    <td>Show Examples for Flowers, HGs and Landed Costs, Integration with Intacct</td>
                                    <td></td>
                                </tr>
                                <tr class="break-row">
                                    <td>2025-07-30</td>
                                    <td>10:30 â€“ 10:45</td>
                                    <td>Break</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-30</td>
                                    <td>10:45 â€“ 12:15</td>
                                    <td>9. Pending to Develop</td>
                                    <td>Month-end prototype, HG/service invoices, OE/PO credit workflows.</td>
                                    <td></td>
                                </tr>
                                <tr class="break-row">
                                    <td>2025-07-30</td>
                                    <td>12:15 â€“ 1:15</td>
                                    <td>Lunch</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                
                                <tr class="day-header">
                                    <td colspan="5"><strong>July 31, 2025 - Day 4: Implementation Strategy</strong></td>
                                </tr>
                                <tr>
                                    <td>2025-07-31</td>
                                    <td>9:00 â€“ 10:30</td>
                                    <td>11. Implementation Strategy/Integration With Intacct</td>
                                    <td>Initial data upload(Inventories,Costs,balances) Module rollout, Macola robot automation, data accuracy safeguards. Workato integration scope, flow syncs, and exception handling.</td>
                                    <td>Define Timelines/Teams Ricardo/David- Misma pagina</td>
                                </tr>
                                <tr class="break-row">
                                    <td>2025-07-31</td>
                                    <td>10:30 â€“ 10:45</td>
                                    <td>Break</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-31</td>
                                    <td>10:45 â€“ 11:00</td>
                                    <td>12. Reporting, VU </td>
                                    <td>Report continuity,future handoff to VU. (Jose) </td>
                                    <td></td>
                                </tr>
                                 <tr>
                                    <td>2025-07-31</td>
                                    <td>11:00 â€“ 12:00</td>
                                    <td>13. Intacct Rollout Planning</td>
                                    <td>AP/AR go-live plan, UAT schedule, training support needs. (Alejandra,Tomas)</td>
                                    <td></td>
                                </tr>

                                <tr class="break-row">
                                    <td>2025-07-31</td>
                                    <td>12:00 â€“ 1:00</td>
                                    <td>Lunch</td>
                                    <td></td>
                                    <td></td>
                                </tr>
                                <tr>
                                    <td>2025-07-31</td>
                                    <td>1:00 â€“ 2:00</td>
                                    <td>Open Q&A & Feedback</td>
                                    <td>Open discussion, gap identification, resource needs.</td>
                                    <td>Anna</td>
                                </tr>

                                <tr>
                                    <td>2025-07-31</td>
                                    <td>2:00 â€“ 3:00</td>
                                    <td>Final Wrap-Up</td>
                                    <td>Confirm commitments, align on communication plans and next steps.</td>
                                    <td>Anna - Luis</td>
                                </tr>
                                
                                                             
                                
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>



               <!-- Context -->

           <div class="section">
    <div class="section-header" onclick="toggleSection('historical-context')">
      <h2>Historical Context</h2>
      <div class="qa-icon" onclick="openQAModal(event, 'historical-context')" data-section="historical-context">ðŸ’¬</div>
      <button class="toggle-btn" id="toggle-historical-context">â–¼</button>
    </div>
       
    <div class="section-content collapsed" id="historical-context">
      <div class="historical-timeline">
        <div class="timeline-item" style="--item-index: 1">
          <div class="year-badge">2008</div>
          <div class="content-box">
            <p class="content-text">WebFlowers was implemented at Monterey Bay, marking the beginning of our digital transformation journey.</p>
          </div>
        </div>

        <div class="timeline-item milestone" style="--item-index: 2">
          <div class="milestone-indicator">Milestone</div>
          <div class="year-badge">2010</div>
          <div class="content-box">
            <p class="content-text">Implementation was completed at the Kendal's site. During this period, dual data entry was required in both WebFlowers and Macola.</p>
          </div>
        </div>

        <div class="timeline-item" style="--item-index: 3">
          <div class="year-badge">2011</div>
          <div class="content-box">
            <p class="content-text">Discussions around a potential system integration project began, laying the groundwork for future unification efforts.</p>
          </div>
        </div>

        <div class="timeline-item" style="--item-index: 4">
          <div class="year-badge">2012</div>
          <div class="content-box">
            <p class="content-text">The integration process was paused due to strategic reassessment and resource allocation considerations.</p>
          </div>
        </div>

        <div class="timeline-item milestone" style="--item-index: 5">
          <div class="milestone-indicator">Achievement</div>
          <div class="year-badge">2014-2017</div>
          <div class="content-box">
            <p class="content-text">Dual data entry between WebFlowers and Macola was eliminated through internal development on the West Coast, significantly improving operational efficiency.</p>
          </div>
        </div>

        <div class="timeline-item" style="--item-index: 6">
          <div class="year-badge">2019</div>
          <div class="content-box">
            <p class="content-text">"Exact" sold Macola to ECI. Alternative systems were evaluated to replace Macola. The West Coast team recommended NetSuite, as Intacct did not offer any manufacturing modules.</p>
          </div>
        </div>

        <div class="timeline-item milestone" style="--item-index: 7">
          <div class="milestone-indicator">Decision</div>
          <div class="year-badge">2022</div>
          <div class="content-box">
            <p class="content-text">The decision was made to align the companies' organizational strategy and to develop the Costing System modules within WebFlowers.</p>
          </div>
        </div>

        <div class="timeline-item milestone" style="--item-index: 8">
          <div class="milestone-indicator">Launch</div>
          <div class="year-badge">2023</div>
          <div class="content-box">
            <p class="content-text">Expectations were unified, marking the beginning of the official new project development phase and setting the stage for comprehensive system integration.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
            

           

             <!-- ERP Integration Chart Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('erp-integration')">
                    <h2>WebFlowers - Macola (Current Architecture)</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'erp-integration')" data-section="erp-integration">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-erp-integration">â–¼</button>
                </div>
                <div class="section-content collapsed" id="erp-integration">
                    <div class="erp-integration-container">
                        <div class="diagram-title">Initial status</div>
                        <p style="text-align: center; margin: 0px; ">It does not allow the unification of accounting in Intacct for the companies in the United States.</p>
                        <img src="img/img wf intacct.png" alt="">
                    </div>

                </div>
            </div>
                
        <div class="section">
        <div class="section-header" onclick="toggleSection('final-release')">
            <h2>WebFlowers - Intacct (Future Architecture)</h2>
            <div class="qa-icon" onclick="openQAModal(event, 'final-release')" data-section="final-release">ðŸ’¬</div>
            <button class="toggle-btn" id="toggle-final-release">â–¼</button>
        </div>

                <div class="section-content collapsed" id="final-release">
                    <div class="erp-integration-container">
                        <div class="diagram-title">Final release</div>
                        <!--DiseÃ±o -->
                            <div class="cont-graphics" style="position: relative; margin-top: 80px;">
                            <!-- Web Flowers Modules -->
                            <div class="erp-module wf-erp-module erp-oe" data-target="list-oe">OE</div>
                            <div class="erp-module wf-erp-module erp-bom" data-target="list-bom">BOM</div>
                            <div class="erp-module wf-erp-module erp-pop" data-target="list-pop">POP</div>
                            <div class="erp-module wf-erp-module erp-im" data-target="list-im">IM</div>
                            <div class="erp-module wf-erp-module erp-po-lc" data-target="list-polc">PO+LC</div>

                            <!-- Intacct Modules (no funcionalidad aplicada aÃºn) -->
                            <div class="erp-module intacct-erp-module erp-gl central-erp-hub">GL</div>
                            <div class="erp-module intacct-erp-module erp-cm">CM</div>
                            <div class="erp-module intacct-erp-module erp-ad">AD</div>
                            <div class="erp-module intacct-erp-module erp-ar">AR</div>
                            <div class="erp-module intacct-erp-module erp-ap">AP</div>
                            <div class="erp-module intacct-erp-module erp-pr">PR</div>
                            <div class="erp-module intacct-erp-module erp-bb">BB</div>
                        </div>

                        <!-- Listas asociadas a cada mÃ³dulo -->
                        <div class="list-item" id="list-oe" style="top: 190px;right: 190px;">OE
                            <h4>Accounting</h4>
                            <ul>
                                <li>invoicing</li>
                            </ul>
                            <h4>Customer</h4>
                            <ul>
                                <li>Customer group + other specification</li>
                            </ul>
                            <h4>Inventory</h4>
                            <ul>
                                <li>Distribution File (AR)</li>
                            </ul>
                        </div>
                        <div class="list-item" id="list-bom" style="top: 190px;right: 190px;">BOM
                            <h4>Inventory</h4>
                            <ul>
                                <li>Costing group (bulk, products, hardgoods)</li>
                                <li>Audit</li>
                                <li>Material cost type</li>
                                <li>Product Category</li>
                            </ul>
                            <h4>Reports</h4>
                            <ul>
                                <li>Costing group summary</li>
                            </ul>
                        </div>
                        <div class="list-item" id="list-pop" style="top: 190px;right: 190px;">POP
                            <h4>Inventory</h4>
                            <ul>
                                <li>Production reporting</li>
                                <li>Products disassembly</li>
                            </ul>
                        </div>
                        <div class="list-item" id="list-im" style="top: 190px;right: 190px;">IM
                            <h4>Inventory</h4>
                            <ul>
                                <li>Adjustments</li>
                                <li>Report</li>
                                <li>Distribution file (IM)</li>
                                <li>Log</li>
                            </ul>
                        </div>
                        <div class="list-item" id="list-polc" style="top: 190px;right: 190px;">PO+LC
                            <h4>Procurement</h4>
                            <ul>
                                <li>Costing system Acceptance</li>
                                <li>Post to AP</li>
                                <li>Landed cost codes</li>
                                <li>Landed cost rules</li>
                                <li>New PO (bulk, product, hardgoods)</li>
                            </ul>
                            <h4>Reports</h4>
                            <ul>
                                <li>Landed cost Reports</li>
                            </ul>
                            <h4>Inventory</h4>
                            <ul>
                                <li>Distribution file</li>
                            </ul>
                        </div>

                        <!-- System Modules -->
                        <div class="system-modules" style="position: relative;">
                            <div class="erp-module system-erp-module erp-master-tables">
                                <div style="font-size: 11px; margin-bottom: 3px;">Master Tables</div>
                                <div style="font-size: 8px; opacity: 0.9;">Vendors, Customers, Chart of Accounts</div>
                            </div>
                            
                            <div class="erp-module system-erp-module erp-budget-system">
                                <div style="font-size: 11px; margin-bottom: 3px;">Budget System</div>
                                <div style="font-size: 8px; opacity: 0.9;">Planning & Forecasting</div>
                            </div>
                            
                            <div class="erp-module system-erp-module erp-vu-warehouse">
                                <div style="margin-bottom: 4px;">VU - Business Intelligence Data Warehouse</div>
                                <div style="font-size: 11px; opacity: 0.9;">Dashboards - Reports - Analytics -Data Integration</div>
                            </div>
                        </div>  
                        
                        <!-- Connection Lines -->
                        <div class="erp-connection-line erp-data-flow" style="top: 280px; left: 250px; width: 75px;"></div>
                        <div class="erp-arrow erp-arrow-red" style="top: 180px; left: 428px;"></div>
                        
                        <!-- Integration Flows -->
                        <div class="erp-connection-line erp-data-flow" style="top: 205px; left: 250px; width: 35px;"></div>
                        <div class="erp-arrow erp-arrow-red" style="top: 115px; left: 275px;"></div>
                        
                        <div class="erp-connection-line erp-data-flow" style="top: 355px; left: 250px; width: 35px;"></div>
                        <div class="erp-arrow erp-arrow-red" style="top: 226px; left: 300px;"></div>
                        
                        <div class="erp-legend">
                            <h4>Legend</h4>
                            <div class="erp-legend-item">
                                <div class="erp-legend-color" style="background: linear-gradient(135deg, #f9f871 0%, #e6d435 100%); border-color: #d4b429;"></div>
                                Web Flowers
                            </div>
                            <div class="erp-legend-item">
                                <div class="erp-legend-color" style="background: linear-gradient(135deg, #b3d9ff 0%, #7fc4ff 100%); border-color: #5ba3d0;"></div>
                                Intacct
                            </div>
                            <div class="erp-legend-item">
                                <div class="erp-legend-line" style="background: #e74c3c; height: 4px;"></div>
                                Data Integration
                            </div>
                        </div>
                        <div class="brand-img">
                            <img src="./img/image 14.png" alt="">
                            <img src="img/image 15.png" alt="">
                            <img src="img/wf.png" alt="">
                             <img src="img/image 19.png" alt="">
                        </div>
                    </div>     
                
                    
                    <div class="erp-reports-section">
                        <div class="erp-reports-title">Financial Reports & Analytics</div>
                        <div class="erp-reports-grid">
                            <div class="erp-report-category">
                                <h4>Core Financial Reports</h4>
                                <ul>
                                    <li> P&L Statement</li>
                                    <li> Balance Sheet</li>
                                    <li> Cash Flow Statement</li>
                                    <li> Trial Balance</li>
                                    <li> General Ledger Detail</li>
                                    <li> Budget vs Actual</li>
                                    <li> Variance Analysis</li>
                                    <li> Financial Ratios</li>
                                    <li> Aged A/R & A/P</li>
                                    <li> Bank Reconciliation</li>
                                </ul>
                            </div>
                            <div class="erp-report-category">
                                <h4>Flower Operations Reports</h4>
                                <ul>
                                    <li>Flower Procurement Cost Analysis</li>
                                    <li>Production Order Profitability</li>
                                    <li>Fresh Inventory Turnover</li>
                                    <li>Bill of Materials Costing</li>
                                    <li>Order Entry Performance</li>
                                    <li>Landed Cost per Unit</li>
                                    <li>Vendor Performance Metrics</li>
                                    <li>Quality Control Reports</li>
                                    <li>Seasonal Trend Analysis</li>
                                    <li>Waste & Spoilage Tracking</li>
                                </ul>
                            </div>
                          <div class="erp-report-category">
                                <h4>Flower Operations Reports</h4>
                                <ul>
                                    <li>Flower Procurement Cost Analysis</li>
                                    <li>Production Order Profitability</li>
                                    <li>Fresh Inventory Turnover</li>
                                    <li>Bill of Materials Costing</li>
                                    <li>Order Entry Performance</li>
                                    <li>Landed Cost per Unit</li>
                                    <li>Vendor Performance Metrics</li>
                                    <li>Quality Control Reports</li>
                                    <li>Seasonal Trend Analysis</li>
                                    <li>Waste & Spoilage Tracking</li>
                                </ul>
                            </div>   
                        </div>
                    </div>
                </div>
            </div>

            <!-- Meeting Goals Enhanced -->
<div class="section">
    <div class="section-header" onclick="toggleSection('MeetingGoals')">
        <h2>Meeting Goals</h2>
        <div class="qa-icon" onclick="openQAModal(event, 'MeetingGoals')" data-section="MeetingGoals">ðŸ’¬</div>
        <button class="toggle-btn" id="toggle-MeetingGoals">â–¼</button>
    </div>
    <div class="section-content collapsed" id="MeetingGoals">
        <div class="meeting-goals-container">
            <div class="goals-item">
                <div class="goals-number">1</div>
                <div class="goals-text">Review current project status and completed milestones</div>
            </div>
            <div class="goals-item">
                <div class="goals-number">2</div>
                <div class="goals-text">Provide comprehensive basic training on new system features</div>
            </div>
            <div class="goals-item">
                <div class="goals-number">3</div>
                <div class="goals-text">Prepare and validate sandbox environment for go-live testing</div>
            </div>
            <div class="goals-item">
                <div class="goals-number">4</div>
                <div class="goals-text">Establish clear agreements on responsibilities and define next steps</div>
            </div>
        </div>
    </div>
</div>


         

     

            <!-- PO Acceptance Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('po-acceptance')">
                    <h2>PO Acceptance Process</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'po-acceptance')" data-section="po-acceptance">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-po-acceptance">â–¼</button>
                </div>
                <div class="section-content collapsed" id="po-acceptance">
                    <div class="key-benefits">
                        <h4>Key Benefits</h4>
                        <ul>
                            <li>Makes PO posting a permanent transaction for better control</li>
                            <li>Acts as final accuracy check and confirms full receipt of goods</li>
                            <li>Assigns accountable owner to reduce errors</li>
                            <li>Enables inventory location definition (e.g., SLC/MIA)</li>
                        </ul>
                    </div>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">PO Acceptance Transaction Flow</div>
                        <svg id="po-sankey" width="800" height="300"></svg>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Workflow Journal Entries</h4>
                        <div class="entry-item">
                            <span class="debit">D - Inventory</span>
                            <span>Increase inventory value</span>
                        </div>
                        <div class="entry-item">
                            <span class="credit">C - Purchases Clearing (Flowers/HG)</span>
                            <span>Clear purchase obligations</span>
                        </div>
                        <div class="entry-item">
                            <span class="credit">C - Purchases Clearing (Freight)</span>
                            <span>Clear freight charges</span>
                        </div>
                    </div>
                    
                    <div class="process-step">
                        <h4>Workflow Transactions</h4>
                        <ul>
                            <li><strong>Update Inventory:</strong> Adjust quantity and location</li>
                            <li><strong>Land The Cost:</strong> Track into separate bucket for accurate costing</li>
                            <li><strong>Recalculate Average Cost:</strong> Update weighted average cost basis</li>
                        </ul>
                    </div>
                </div>
            </div>
            
             <!-- Inventory Management Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('inventory-management')">
                    <h2>IM - Inventory Management</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'inventory-management')" data-section="inventory-management">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-inventory-management">â–¼</button>
                </div>
                <div class="section-content collapsed" id="inventory-management">
                    <div class="key-benefits">
                        <h4>Transaction Types</h4>
                        <ul>
                            <li><strong>Adjustments:</strong> Quantity and value corrections</li>
                            <li><strong>Issues:</strong> Inventory consumption tracking</li>
                            <li><strong>Receipts:</strong> Inventory additions</li>
                            <li><strong>Transfers:</strong> Location-to-location movements</li>
                        </ul>
                    </div>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">Inventory Management Transaction Flow</div>
                        <svg id="inventory-sankey" width="800" height="350"></svg>
                    </div>
                    
                    <div class="process-step">
                        <h4>System Capabilities</h4>
                        <p>Adjusts inventory quantities, costs, and GL accounts based on user input, similar to Macola functionality. Serves as foundation for future enhancements like TA module integration and approval workflows.</p>
                    </div>
                    
                    <div class="future-enhancements">
                        <h4>Future Enhancements</h4>
                        <ul>
                            <li>TA module integration for advanced analytics</li>
                            <li>Approval workflows for inventory transactions</li>
                            <li>Enhanced reporting capabilities</li>
                        </ul>
                    </div>
                </div>
            </div>
          
            
            <!-- Production Reporting Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('production-reporting')">
                    <h2>POP - Production Reporting</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'production-reporting')" data-section="production-reporting">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-production-reporting">â–¼</button>
                </div>
                <div class="section-content collapsed" id="production-reporting">
                    <div class="key-benefits">
                        <h4>Process Controls</h4>
                        <ul>
                            <li>Same controls as PO Acceptance: requires user validation before posting</li>
                            <li>Allows BOM adjustments (adding/removing vases, food, etc.) to match actual usage</li>
                            <li>Updates WF Finished Goods inventory accurately</li>
                        </ul>
                    </div>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">Production Reporting Transaction Flow</div>
                        <svg id="production-sankey" width="800" height="300"></svg>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Workflow Journal Entries</h4>
                        <div class="entry-item">
                            <span class="credit">C - Raw Materials</span>
                            <span>Consume raw material inventory</span>
                        </div>
                        <div class="entry-item">
                            <span class="debit">D - Finished Goods</span>
                            <span>Increase finished goods inventory</span>
                        </div>
                        <p><em>WIP account exists but is not currently used due to short production cycles</em></p>
                    </div>
                    
                    <div class="process-step">
                        <h4>Inventory Transactions</h4>
                        <ul>
                            <li><strong>Raw Materials:</strong> Consumes inventory based on actual usage</li>
                            <li><strong>Finished Goods:</strong> Increases inventory and adjusts average cost accordingly</li>
                        </ul>
                    </div>
                    
                    <div class="future-enhancements">
                        <h4>Future Enhancements</h4>
                        <p>Value-Added Cost tracking may be included in future releases to provide more detailed production costing.</p>
                    </div>
                </div>
            </div>
            
            <!-- Order Entry Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('order-entry')">
                    <h2>OE - Order Entry & Invoicing</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'order-entry')" data-section="order-entry">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-order-entry">â–¼</button>
                </div>
                <div class="section-content collapsed" id="order-entry">
                    <div class="key-benefits">
                        <h4>Process Overview</h4>
                        <ul>
                            <li>Invoicing occurs in WF with invoices remaining Open until posted</li>
                            <li>New posting process added specifically for the costing system</li>
                            <li>Supports multi-location invoicing (e.g., SLC inventory management)</li>
                        </ul>
                    </div>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">Order Entry Transaction Flow</div>
                        <svg id="order-entry-sankey" width="800" height="400"></svg>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Workflow Journal Entries</h4>
                        <div class="entry-item">
                            <span class="credit">C - Finished Goods / Raw Materials Inventory</span>
                            <span>Reduce inventory for sold items</span>
                        </div>
                        <div class="entry-item">
                            <span class="debit">D - COGS</span>
                            <span>Record cost of goods sold</span>
                        </div>
                        <div class="entry-item">
                            <span class="debit">D - AR Transfer to Intacct</span>
                            <span>Transfer receivable to Intacct</span>
                        </div>
                        <div class="entry-item">
                            <span class="credit">C - Revenue</span>
                            <span>Record sales revenue</span>
                        </div>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Intacct Journal Entries</h4>
                        <div class="entry-item">
                            <span class="debit">D - Accounts Receivable</span>
                            <span>Record customer receivable</span>
                        </div>
                        <div class="entry-item">
                            <span class="credit">C - AR Transfer to Intacct</span>
                            <span>Complete transfer process</span>
                        </div>
                    </div>
                    
                    <div class="process-step">
                        <h4>Inventory Transactions</h4>
                        <p>Reduces inventory of sold items and updates average cost calculations for remaining inventory.</p>
                    </div>
                    
                    <div class="process-step">
                        <h4>Intacct Documents</h4>
                        <ul>
                            <li><strong>AR Invoice:</strong> Customer billing document</li>
                            <li><strong>AR Credit:</strong> Credit memo processing</li>
                        </ul>
                        <p>Month-end reconciliation clears the AR Transfer to Intacct account.</p>
                    </div>
                    
                    <div class="future-enhancements">
                        <h4>Development Status</h4>
                        <p>Credit module is currently under development for comprehensive credit memo handling.</p>
                    </div>
                </div>
            </div>


              <!-- Three-Way Match Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('three-way-match')">
                    <h2>PO/AP Three-Way Match Process</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'three-way-match')" data-section="three-way-match">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-three-way-match">â–¼</button>
                </div>
                <div class="section-content collapsed" id="three-way-match">
                    <div class="key-benefits">
                        <h4>Process Overview</h4>
                        <ul>
                            <li>AP/Production Clerk verifies <strong>Invoice, PO, and Receipt</strong> before posting</li>
                            <li>Records Purchase Price Variance (PPV) and freight differences</li>
                            <li>Transaction pushed to Intacct for final processing</li>
                            <li>Provides simple Landed Cost AP processing</li>
                            <li>Pulls information from related parties to simplify operations</li>
                        </ul>
                    </div>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">Three-Way Match Transaction Flow</div>
                        <svg id="three-way-sankey" width="800" height="400"></svg>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Workflow Journal Entries</h4>
                        <div class="entry-item">
                            <span class="debit">D - Purchases Clearing</span>
                            <span>Clear purchase obligations</span>
                        </div>
                        <div class="entry-item">
                            <span>C/D - Variance Accounts</span>
                            <span>Record PPV and freight differences</span>
                        </div>
                        <div class="entry-item">
                            <span class="credit">C - AP WF to Intacct Transfer</span>
                            <span>Transfer to Intacct system</span>
                        </div>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Intacct Journal Entries</h4>
                        <div class="entry-item">
                            <span class="debit">D - Purchases Clearing</span>
                            <span>Mirror WF clearing entry</span>
                        </div>
                        <div class="entry-item">
                            <span class="credit">C - AP WF to Intacct Transfer</span>
                            <span>Complete transfer process</span>
                        </div>
                        <p><em>Transaction details are stored in notes for audit trail</em></p>
                    </div>
                    
                    <div class="process-step">
                        <h4>Daily/ Month-End Reconciliation</h4>
                        <p>At month-end, a reconciliation process creates clearing entries in both WF and Intacct to zero out the AP WF to Intacct Transfer accounts, ensuring clean month-end balances. However a Daily Reconciliation will exist via a tool</p>
                    </div>
                </div>
            </div>
            
           
            
            <!-- Month-End Close Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('month-end-close')">
                    <h2>IM - Month-End Close Process</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'month-end-close')" data-section="month-end-close">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-month-end-close">â–¼</button>
                </div>
                <div class="section-content collapsed" id="month-end-close">
                    <div class="key-benefits">
                        <h4>Process Overview</h4>
                        <ul>
                            <li>Validates that all processes are completed before close</li>
                            <li>Allows inventory freeze at a specific point in time</li>
                            <li>Uses WF physical counts to post final inventory balances</li>
                            <li>Creates variances for later adjustment via Inventory Transactions</li>
                        </ul>
                    </div>
                    
                    <div class="diagram-container">
                        <div class="diagram-title">Month-End Close Transaction Flow</div>
                        <svg id="month-end-sankey" width="800" height="400"></svg>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Workflow Journal Entries</h4>
                        <div class="entry-item">
                            <span>D/C - Variance</span>
                            <span>Record physical count differences</span>
                        </div>
                        <div class="entry-item">
                            <span>D/C - Inventory</span>
                            <span>Adjust inventory to actual counts</span>
                        </div>
                    </div>
                    
                    <div class="journal-entries">
                        <h4>Intacct Journal Entries</h4>
                        <div class="entry-item">
                            <span class="credit">C - AP Transfer Account</span>
                            <span>Clear AP transfer balance</span>
                        </div>
                        <div class="entry-item">
                            <span class="debit">D - COGS</span>
                            <span>Record cost adjustments</span>
                        </div>
                        <div class="entry-item">
                            <span class="debit">D - AR Transfer Account</span>
                            <span>Clear AR transfer balance</span>
                        </div>
                        <div class="entry-item">
                            <span class="credit">C - Revenue</span>
                            <span>Record revenue adjustments</span>
                        </div>
                    </div>
                    
                    <div class="process-step">
                        <h4>Count Adjustments</h4>
                        <p>Physical count variances are processed through inventory transactions to ensure accurate month-end balances and proper variance tracking. Reconciliation process for Transfer Accounts and reset balances against a month closing AP and AR Account</p>
                    </div>
                </div>
            </div>

            
       <!-- Project Timeline Section -->
            <div class="section">
                <div class="section-header" onclick="toggleSection('Timeline')">
                    <h2>Project TimeLine</h2>
                    <div class="qa-icon" onclick="openQAModal(event, 'TimeLine')" data-section="TimeLine">ðŸ’¬</div>
                    <button class="toggle-btn" id="toggle-Timeline">â–¼</button>
                </div>
                <div class="section-content collapsed" id="Timeline">
                  
 

                    <div class="prjtimeline-container">
   
    
    <div class="prjtimeline">
      <div class="prjtimeline-item completed" style="--item-index: 1">
        <div class="prjtimeline-content">
          <div class="status-badge status-completed">Completed</div>
          <div class="date">Oct. 2022</div>
          <div class="description">Project Kick off.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item completed" style="--item-index: 2">
        <div class="prjtimeline-content">
          <div class="status-badge status-completed">Completed</div>
          <div class="date">Dec. 2023</div>
          <div class="description">Landed cost implementation and optimization.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item completed" style="--item-index: 3">
        <div class="prjtimeline-content">
          <div class="status-badge status-completed">Completed</div>
          <div class="date">Apr. 2024</div>
          <div class="description">Inventory management system deployment.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item completed" style="--item-index: 4">
        <div class="prjtimeline-content">
          <div class="status-badge status-completed">Completed</div>
          <div class="date">Sep. 2024</div>
          <div class="description">Production reporting framework established.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item completed" style="--item-index: 5">
        <div class="prjtimeline-content">
          <div class="status-badge status-completed">Completed</div>
          <div class="date">Mar. 2025</div>
          <div class="description">Accounts payable integration completed.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item completed" style="--item-index: 6">
        <div class="prjtimeline-content">
          <div class="status-badge status-completed">Completed</div>
          <div class="date">Jun. 2025</div>
          <div class="description">Location concept development finalized.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item completed" style="--item-index: 7">
        <div class="prjtimeline-content">
          <div class="status-badge status-completed">Completed</div>
          <div class="date">Jul. 2025</div>
          <div class="description">Physical count end-of-month prototype delivered.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item current" style="--item-index: 8">
        <div class="prjtimeline-content">
          <div class="status-badge status-current">In Progress</div>
          <div class="date">Jul.-Aug. 2025</div>
          <div class="description">West Coast stakeholder meeting and alignment session.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item future" style="--item-index: 9">
        <div class="prjtimeline-content">
          <div class="status-badge status-future">Upcoming</div>
          <div class="date">Aug.-Sept. 2025</div>
          <div class="description">Intact configuration. Master data setup: vendors, customers and Chart of Accounts.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item future" style="--item-index: 10">
        <div class="prjtimeline-content">
          <div class="status-badge status-future">Upcoming</div>
          <div class="date">Sep. 2025</div>
          <div class="description">First "Workato" integration for AP, AR (finished goods) and inventory general ledger journal entries.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item future" style="--item-index: 11">
        <div class="prjtimeline-content">
          <div class="status-badge status-future">Upcoming</div>
          <div class="date">Nov. 2025</div>
          <div class="description">Finalize Inventory Management development and testing phase.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item future" style="--item-index: 12">
        <div class="prjtimeline-content">
          <div class="status-badge status-future">Upcoming</div>
          <div class="date">Mar. 2026</div>
          <div class="description">Finalize Order Entry development, enabling sales of hardgoods, services, and credit management.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item future" style="--item-index: 13">
        <div class="prjtimeline-content">
          <div class="status-badge status-future">Upcoming</div>
          <div class="date">Jun. 2026</div>
          <div class="description">Final release: Complete "Intact" integration and system consolidation.</div>
        </div>
      </div>
      
      <div class="prjtimeline-item future" style="--item-index: 14">
        <div class="prjtimeline-content">
          <div class="status-badge status-future">Upcoming</div>
          <div class="date">Jul.-Aug. 2026</div>
          <div class="description">Comprehensive testing phase and Macola system deactivation.</div>
        </div>
      </div>
    </div>
  </div>



</div>


                </div>
           


       

        
    <!-- Q&A Summary Section -->
    <div class="section">
        <div class="section-header" onclick="toggleSection('qa-summary')">
            <h2>Q&A Summary</h2>
            <button class="toggle-btn" id="toggle-qa-summary">â–¼</button>
        </div>
        <div class="section-content collapsed" id="qa-summary">
            <div class="qa-summary-section">
                <div class="qa-summary-title">Meeting Questions & Notes Summary</div>
                <div id="qaSummaryContent">
                    <p style="text-align: center; color: #7f8c8d; font-style: italic;">Questions and notes will appear here as they are added during the meeting.</p>
                </div>
            </div>
        </div>
    </div>

     </div>
     </div>

    </div>


    <!-- Q&A Modal -->
<div id="qaModal" class="qa-modal">
    <div class="qa-modal-content">
        <div class="qa-modal-header">
            <h3 id="qaModalTitle">Q&A - Section</h3>
            <button class="qa-close" onclick="closeQAModal()">&times;</button>
        </div>
        <div class="qa-chat-container" id="qaChatContainer">
            <div class="qa-user-info">
                <div class="qa-user-avatar" id="userAvatar">U</div>
                <input type="text" id="userName" class="qa-user-input" placeholder="Your name" maxlength="20">
                <span style="font-size: 12px; color: #7f8c8d;">Enter your name to participate</span>
            </div>
            <div id="qaMessages"></div>
        </div>
        <div class="qa-input-container">
            <div class="qa-type-selector">
                <button class="qa-type-btn active" data-type="note" onclick="selectMessageType('note')">Note</button>
                <button class="qa-type-btn" data-type="question" onclick="selectMessageType('question')">Question</button>
                <button class="qa-type-btn" data-type="answer" onclick="selectMessageType('answer')">Answer</button>
            </div>
            <div class="qa-input-row">
                <input type="text" id="qaInput" class="qa-input" placeholder="Type your message..." maxlength="500">
                <button id="qaSendBtn" class="qa-send-btn" onclick="sendMessage()">Send</button>
            </div>
        </div>
    </div>
</div>


    
    <script>
        //DiseÃ±o 
         const modules = document.querySelectorAll('.wf-erp-module');

        modules.forEach(module => {
            module.addEventListener('click', () => {
                const targetId = module.getAttribute('data-target');
                const targetEl = document.getElementById(targetId);

                // Ocultar todas las demÃ¡s listas primero
                document.querySelectorAll('.list-item').forEach(el => {
                    if (el.id !== targetId) el.style.display = 'none';
                });

                // Mostrar u ocultar la lista clicada
                if (targetEl.style.display === 'none' || targetEl.style.display === '') {
                    targetEl.style.display = 'block';
                } else {
                    targetEl.style.display = 'none';
                }
            });
        });


        // Toggle section functionality
        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId);
            const toggle = document.getElementById('toggle-' + sectionId);
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                toggle.textContent = 'â–¼';
                toggle.classList.remove('rotated');
            } else {
                content.classList.add('collapsed');
                toggle.textContent = 'â–¼';
                toggle.classList.add('rotated');
            }
        }
        
        // Sankey diagram creation function
        function createSankey(containerId, data) {
            const margin = {top: 20, right: 20, bottom: 20, left: 20};
            const width = 800 - margin.left - margin.right;
            const height = data.height - margin.top - margin.bottom;
            
            const svg = d3.select('#' + containerId)
                .attr('width', width + margin.left + margin.right)
                .attr('height', height + margin.top + margin.bottom);
            
            const g = svg.append('g')
                .attr('transform', `translate(${margin.left},${margin.top})`);
            
            // Create nodes
            const nodes = data.nodes.map((d, i) => ({
                ...d,
                x: d.x * width,
                y: d.y * height,
                width: 120,
                height: 30
            }));
            
            // Create links
            const links = data.links.map(d => ({
                ...d,
                source: nodes[d.source],
                target: nodes[d.target]
            }));
            
            // Draw links
            g.selectAll('.link')
                .data(links)
                .enter().append('path')
                .attr('class', 'link')
                .attr('d', d => {
                    const sourceX = d.source.x + d.source.width;
                    const sourceY = d.source.y + d.source.height / 2;
                    const targetX = d.target.x;
                    const targetY = d.target.y + d.target.height / 2;
                    const midX = (sourceX + targetX) / 2;
                    
                    return `M${sourceX},${sourceY} C${midX},${sourceY} ${midX},${targetY} ${targetX},${targetY}`;
                })
                .style('fill', 'none')
                .style('stroke', d => d.color || '#3498db')
                .style('stroke-width', d => d.width || 2)
                .style('opacity', 0.7);
            
            // Draw nodes
            const node = g.selectAll('.node')
                .data(nodes)
                .enter().append('g')
                .attr('class', 'node')
                .attr('transform', d => `translate(${d.x},${d.y})`);
            
            node.append('rect')
                .attr('width', d => d.width)
                .attr('height', d => d.height)
                .style('fill', d => d.color || '#34495e')
                .style('stroke', '#2c3e50')
                .style('stroke-width', 1)
                .style('rx', 5);
            
            node.append('text')
                .attr('x', d => d.width / 2)
                .attr('y', d => d.height / 2)
                .attr('dy', '0.35em')
                .style('text-anchor', 'middle')
                .style('fill', 'white')
                .style('font-size', '12px')
                .style('font-weight', 'bold')
                .text(d => d.name);
        }
        
        // Initialize all Sankey diagrams
        document.addEventListener('DOMContentLoaded', function() {
            // PO Acceptance Sankey
            createSankey('po-sankey', {
                height: 300,
                nodes: [
                    {name: 'PO Receipt', x: 0, y: 0.2, color: '#e74c3c'},
                    {name: 'PO Acceptance', x: 0.25, y: 0.4, color: '#9b59b6'},
                    {name: 'Inventory', x: 0.5, y: 0.1, color: '#27ae60'},
                    {name: 'Purchases Clearing', x: 0.5, y: 0.5, color: '#f39c12'},
                    {name: 'Freight Clearing', x: 0.5, y: 0.8, color: '#e67e22'},
                    {name: 'Update Inventory', x: 0.75, y: 0.2, color: '#3498db'},
                    {name: 'Recalc Avg Cost', x: 0.75, y: 0.6, color: '#1abc9c'}
                ],
                links: [
                    {source: 0, target: 1, color: '#e74c3c', width: 3},
                    {source: 1, target: 2, color: '#27ae60', width: 3},
                    {source: 1, target: 3, color: '#f39c12', width: 3},
                    {source: 1, target: 4, color: '#e67e22', width: 3},
                    {source: 2, target: 5, color: '#3498db', width: 2},
                    {source: 2, target: 6, color: '#1abc9c', width: 2}
                ]
            });
            
            // Three-Way Match Sankey
            createSankey('three-way-sankey', {
                height: 400,
                nodes: [
                    {name: 'Invoice', x: 0, y: 0.1, color: '#e74c3c'},
                    {name: 'PO', x: 0, y: 0.4, color: '#9b59b6'},
                    {name: 'Receipt', x: 0, y: 0.7, color: '#27ae60'},
                    {name: 'Three-Way Match', x: 0.25, y: 0.4, color: '#34495e'},
                    {name: 'Purchases Clearing', x: 0.5, y: 0.2, color: '#f39c12'},
                    {name: 'Variance Accounts', x: 0.5, y: 0.4, color: '#e67e22'},
                    {name: 'WF to Intacct', x: 0.5, y: 0.6, color: '#3498db'},
                    {name: 'Intacct Processing', x: 0.75, y: 0.4, color: '#1abc9c'}
                ],
                links: [
                    {source: 0, target: 3, color: '#e74c3c', width: 2},
                    {source: 1, target: 3, color: '#9b59b6', width: 2},
                    {source: 2, target: 3, color: '#27ae60', width: 2},
                    {source: 3, target: 4, color: '#f39c12', width: 3},
                    {source: 3, target: 5, color: '#e67e22', width: 2},
                    {source: 3, target: 6, color: '#3498db', width: 3},
                    {source: 6, target: 7, color: '#1abc9c', width: 3}
                ]
            });
            
            // Production Reporting Sankey
            createSankey('production-sankey', {
                height: 300,
                nodes: [
                    {name: 'Raw Materials', x: 0, y: 0.3, color: '#e74c3c'},
                    {name: 'Production Process', x: 0.33, y: 0.4, color: '#9b59b6'},
                    {name: 'BOM Adjustments', x: 0.33, y: 0.7, color: '#e67e22'},
                    {name: 'Finished Goods', x: 0.66, y: 0.2, color: '#27ae60'},
                    {name: 'Cost Calculation', x: 0.66, y: 0.6, color: '#3498db'}
                ],
                links: [
                    {source: 0, target: 1, color: '#e74c3c', width: 3},
                    {source: 2, target: 1, color: '#e67e22', width: 2},
                    {source: 1, target: 3, color: '#27ae60', width: 3},
                    {source: 1, target: 4, color: '#3498db', width: 2}
                ]
            });
            
            // Order Entry Sankey
            createSankey('order-entry-sankey', {
                height: 400,
                nodes: [
                    {name: 'Customer Order', x: 0, y: 0.3, color: '#e74c3c'},
                    {name: 'WF Invoice', x: 0.2, y: 0.4, color: '#9b59b6'},
                    {name: 'Inventory', x: 0.4, y: 0.1, color: '#27ae60'},
                    {name: 'COGS', x: 0.4, y: 0.35, color: '#f39c12'},
                    {name: 'AR Transfer', x: 0.4, y: 0.6, color: '#3498db'},
                    {name: 'Revenue', x: 0.4, y: 0.85, color: '#1abc9c'},
                    {name: 'Intacct AR', x: 0.6, y: 0.6, color: '#34495e'},
                    {name: 'Payments', x: 0.8, y: 0.6, color: '#e74c3c'}
                ],
                links: [
                    {source: 0, target: 1, color: '#e74c3c', width: 3},
                    {source: 1, target: 2, color: '#27ae60', width: 2},
                    {source: 1, target: 3, color: '#f39c12', width: 2},
                    {source: 1, target: 4, color: '#3498db', width: 3},
                    {source: 1, target: 5, color: '#1abc9c', width: 3},
                    {source: 4, target: 6, color: '#34495e', width: 3},
                    {source: 6, target: 7, color: '#e74c3c', width: 2}
                ]
            });
            
            // Inventory Management Sankey
            createSankey('inventory-sankey', {
                height: 350,
                nodes: [
                    {name: 'Adjustments', x: 0, y: 0.1, color: '#e74c3c'},
                    {name: 'Issues', x: 0, y: 0.35, color: '#9b59b6'},
                    {name: 'Receipts', x: 0, y: 0.6, color: '#27ae60'},
                    {name: 'Transfers', x: 0, y: 0.85, color: '#e67e22'},
                    {name: 'IM Processing', x: 0.35, y: 0.4, color: '#34495e'},
                    {name: 'Inventory Update', x: 0.65, y: 0.2, color: '#3498db'},
                    {name: 'GL Adjustment', x: 0.65, y: 0.5, color: '#f39c12'},
                    {name: 'Cost Recalc', x: 0.65, y: 0.8, color: '#1abc9c'}
                ],
                links: [
                    {source: 0, target: 4, color: '#e74c3c', width: 2},
                    {source: 1, target: 4, color: '#9b59b6', width: 2},
                    {source: 2, target: 4, color: '#27ae60', width: 2},
                    {source: 3, target: 4, color: '#e67e22', width: 2},
                    {source: 4, target: 5, color: '#3498db', width: 3},
                    {source: 4, target: 6, color: '#f39c12', width: 3},
                    {source: 4, target: 7, color: '#1abc9c', width: 2}
                ]
            });
            
            // Month-End Close Sankey
            createSankey('month-end-sankey', {
                height: 400,
                nodes: [
                    {name: 'Physical Count', x: 0, y: 0.3, color: '#e74c3c'},
                    {name: 'WF Processing', x: 0.2, y: 0.4, color: '#9b59b6'},
                    {name: 'Inventory Adj', x: 0.4, y: 0.1, color: '#27ae60'},
                    {name: 'Variance', x: 0.4, y: 0.35, color: '#f39c12'},
                    {name: 'AP Transfer Clear', x: 0.4, y: 0.6, color: '#3498db'},
                    {name: 'AR Transfer Clear', x: 0.4, y: 0.85, color: '#1abc9c'},
                    {name: 'Intacct Close', x: 0.6, y: 0.4, color: '#34495e'},
                    {name: 'Final Balances', x: 0.8, y: 0.4, color: '#2c3e50'}
                ],
                links: [
                    {source: 0, target: 1, color: '#e74c3c', width: 3},
                    {source: 1, target: 2, color: '#27ae60', width: 2},
                    {source: 1, target: 3, color: '#f39c12', width: 2},
                    {source: 1, target: 4, color: '#3498db', width: 2},
                    {source: 1, target: 5, color: '#1abc9c', width: 2},
                    {source: 4, target: 6, color: '#34495e', width: 2},
                    {source: 5, target: 6, color: '#34495e', width: 2},
                    {source: 6, target: 7, color: '#2c3e50', width: 3}
                ]
            });
        });

/* Questions and Answers System*/

// Firebase Configuration 
const firebaseConfig = {
    apiKey: "AIzaSyBL96eWguQ1WtCGS5U2SL4oSxlnS5luc_c",
    authDomain: "kendalfinancialsystemqa.firebaseapp.com",
    projectId: "kendalfinancialsystemqa",
    storageBucket: "kendalfinancialsystemqa.firebasestorage.app",
    messagingSenderId: "218082018753",
    appId: "1:218082018753:web:ed8bf0c3b9939e58af5b40",
    measurementId: "G-TCYW03BKDS"
  };



// Initialize Firebase with error handling
let db;
try {
    firebase.initializeApp(firebaseConfig);
    db = firebase.firestore();
    console.log('Firebase initialized successfully');
} catch (error) {
    console.error('Firebase initialization error:', error);
    db = null;
}

// Global variables
let currentSection = '';
let currentUser = '';
let currentMessageType = 'note';
let selectedQuestion = null;
let unsubscribe = null;

// Utility functions
function isFirebaseAvailable() {
    return db !== null && typeof db !== 'undefined';
}

function saveToLocalStorage(data) {
    const messages = JSON.parse(localStorage.getItem('qa_messages') || '[]');
    data.id = Date.now().toString();
    data.timestamp = new Date();
    messages.push(data);
    localStorage.setItem('qa_messages', JSON.stringify(messages));
    return data.id;
}

function loadFromLocalStorage(sectionId = null) {
    const messages = JSON.parse(localStorage.getItem('qa_messages') || '[]');
    if (sectionId) {
        return messages.filter(msg => msg.section === sectionId);
    }
    return messages;
}



// Initialize user and event listeners
document.addEventListener('DOMContentLoaded', function() {
    if (!localStorage.getItem('meetingUserId')) {
        localStorage.setItem('meetingUserId', 'user_' + Math.random().toString(36).substr(2, 9));
    }
    
    const savedName = localStorage.getItem('meetingUserName');
    if (savedName) {
        document.getElementById('userName').value = savedName;
        currentUser = savedName;
        updateUserAvatar();
    }
    
    document.getElementById('userName').addEventListener('input', function(e) {
        currentUser = e.target.value.trim();
        localStorage.setItem('meetingUserName', currentUser);
        updateUserAvatar();
    });
    
    document.getElementById('qaInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });
    
    loadQASummary();
    updateAllPendingCounts();
    showConnectionStatus();
});

function updateUserAvatar() {
    const avatar = document.getElementById('userAvatar');
    avatar.textContent = currentUser ? currentUser.charAt(0).toUpperCase() : 'U';
}

function showConnectionStatus() {
    const statusDiv = document.createElement('div');
    statusDiv.style.cssText = `
        position: fixed;
        top: 10px;
        right: 10px;
        padding: 8px 12px;
        border-radius: 5px;
        font-size: 12px;
        font-weight: bold;
        z-index: 1001;
        ${isFirebaseAvailable() ? 
            'background: #27ae60; color: white;' : 
            'background: #f39c12; color: white;'
        }
    `;
    statusDiv.textContent = isFirebaseAvailable() ? 
        'ðŸ”— Real-time sync active' : 
        'ðŸ’¾ Local storage mode';
    
    document.body.appendChild(statusDiv);
    setTimeout(() => statusDiv.remove(), 3000);
}

function openQAModal(event, sectionId) {
    event.stopPropagation();
    currentSection = sectionId;
    selectedQuestion = null;
    clearReplyMode();
    
    const modal = document.getElementById('qaModal');
    const title = document.getElementById('qaModalTitle');
    const sectionNames = {
        'meeting-agenda': 'Meeting Agenda',
        'historical-context': 'Historical Context',
        'erp-integration': 'Current Architecture',
        'final-release': 'Future Architecture',
        'MeetingGoals': 'Meeting Goals',
        'po-acceptance': 'PO Acceptance Process',
        'inventory-management': 'Inventory Management',
        'production-reporting': 'Production Reporting',
        'order-entry': 'Order Entry & Invoicing',
        'three-way-match': 'Three-Way Match Process',
        'month-end-close': 'Month-End Close Process',
        'Timeline': 'Project Timeline'
    };
    
    title.textContent = `Q&A - ${sectionNames[sectionId] || sectionId}`;
    modal.style.display = 'block';
    loadMessages(sectionId);
    setTimeout(() => document.getElementById('qaInput').focus(), 300);
}

function closeQAModal() {
    document.getElementById('qaModal').style.display = 'none';
    selectedQuestion = null;
    clearReplyMode();
    if (unsubscribe) {
        unsubscribe();
    }
}

function selectMessageType(type) {
    currentMessageType = type;
    document.querySelectorAll('.qa-type-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelector(`[data-type="${type}"]`).classList.add('active');
    
    const input = document.getElementById('qaInput');
    const placeholders = {
        'note': 'Type your note...',
        'question': 'Ask your question...',
        'answer': 'Provide your answer...'
    };
    input.placeholder = placeholders[type];
    
    if (type !== 'answer') {
        clearReplyMode();
    }
}

function selectQuestion(questionId, questionData) {
    document.querySelectorAll('.qa-message.question').forEach(msg => msg.classList.remove('selected'));
    
    const questionElement = document.querySelector(`[data-message-id="${questionId}"]`);
    if (questionElement) {
        questionElement.classList.add('selected');
        selectedQuestion = { id: questionId, data: questionData };
        selectMessageType('answer');
        showReplyMode(questionData);
        document.getElementById('qaInput').focus();
    }
}

function showReplyMode(questionData) {
    const inputContainer = document.getElementById('qaInput').parentElement.parentElement;
    inputContainer.classList.add('replying');
    
    const sendBtn = document.getElementById('qaSendBtn');
    sendBtn.classList.add('reply-mode');
    sendBtn.textContent = 'Reply';
    
    const existingIndicator = document.querySelector('.qa-replying-to');
    if (existingIndicator) existingIndicator.remove();
    
    const replyIndicator = document.createElement('div');
    replyIndicator.className = 'qa-replying-to';
    replyIndicator.innerHTML = `
        <div class="qa-replying-to-header">
            <span class="qa-replying-to-label">Replying to ${questionData.user}'s question:</span>
            <button class="qa-clear-reply" onclick="clearReplyMode()" title="Cancel reply">&times;</button>
        </div>
        <div class="qa-replying-to-content">${questionData.text}</div>
    `;
    
    const inputRow = document.querySelector('.qa-input-row');
    inputRow.parentNode.insertBefore(replyIndicator, inputRow);
    document.getElementById('qaInput').placeholder = 'Type your answer...';
}

function clearReplyMode() {
    selectedQuestion = null;
    document.querySelectorAll('.qa-message.question').forEach(msg => msg.classList.remove('selected'));
    
    const inputContainer = document.getElementById('qaInput').parentElement.parentElement;
    inputContainer.classList.remove('replying');
    
    const sendBtn = document.getElementById('qaSendBtn');
    sendBtn.classList.remove('reply-mode');
    sendBtn.textContent = 'Send';
    
    const replyIndicator = document.querySelector('.qa-replying-to');
    if (replyIndicator) replyIndicator.remove();
    
    if (currentMessageType === 'answer') {
        selectMessageType('note');
    }
}

function sendMessage() {
    const input = document.getElementById('qaInput');
    const message = input.value.trim();
    
    if (!message || !currentUser) {
        if (!currentUser) {
            alert('Please enter your name first');
            document.getElementById('userName').focus();
        }
        return;
    }
    
    const messageData = {
        text: message,
        type: currentMessageType,
        user: currentUser,
        userId: localStorage.getItem('meetingUserId'),
        section: currentSection,
        status: currentMessageType === 'question' ? 'pending' : 'posted'
    };
    
    if (selectedQuestion && currentMessageType === 'answer') {
        messageData.replyTo = selectedQuestion.id;
        messageData.isReply = true;
    }
    
    if (isFirebaseAvailable()) {
        messageData.timestamp = firebase.firestore.FieldValue.serverTimestamp();
        
        db.collection('meeting_qa').add(messageData)
            .then((docRef) => {
                input.value = '';
                if (selectedQuestion && currentMessageType === 'answer') {
                    db.collection('meeting_qa').doc(selectedQuestion.id).update({
                        status: 'answered',
                        answeredBy: currentUser,
                        answeredAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    clearReplyMode();
                }
                updatePendingCount(currentSection);
                loadQASummary();
            })
            .catch((error) => {
                console.error('Error sending message:', error);
                fallbackSendMessage(messageData);
            });
    } else {
        fallbackSendMessage(messageData);
    }
}

function fallbackSendMessage(messageData) {
    const input = document.getElementById('qaInput');
    const messageId = saveToLocalStorage(messageData);
    
    if (selectedQuestion && currentMessageType === 'answer') {
        const messages = JSON.parse(localStorage.getItem('qa_messages') || '[]');
        const questionIndex = messages.findIndex(msg => msg.id === selectedQuestion.id);
        if (questionIndex !== -1) {
            messages[questionIndex].status = 'answered';
            messages[questionIndex].answeredBy = currentUser;
            messages[questionIndex].answeredAt = new Date();
            localStorage.setItem('qa_messages', JSON.stringify(messages));
        }
        clearReplyMode();
    }
    
    input.value = '';
    loadMessagesLocal(currentSection);
    updatePendingCountLocal(currentSection);
    loadQASummaryLocal();
}

function loadMessages(sectionId) {
    if (unsubscribe) unsubscribe();
    
    const messagesContainer = document.getElementById('qaMessages');
    messagesContainer.innerHTML = '<div style="text-align: center; color: #7f8c8d; padding: 20px;">Loading messages...</div>';
    
    if (isFirebaseAvailable()) {
        unsubscribe = db.collection('meeting_qa')
            .where('section', '==', sectionId)
            .orderBy('timestamp', 'asc')
            .onSnapshot((snapshot) => {
                renderMessages(snapshot.docs.map(doc => ({...doc.data(), id: doc.id})));
            }, (error) => {
                console.error('Firebase error, falling back to localStorage:', error);
                loadMessagesLocal(sectionId);
            });
    } else {
        loadMessagesLocal(sectionId);
    }
}

function loadMessagesLocal(sectionId) {
    try {
        const messages = loadFromLocalStorage(sectionId);
        renderMessages(messages);
        // Removed recursive setTimeout to prevent crashes
    } catch (error) {
        console.error('Error loading local messages:', error);
        const messagesContainer = document.getElementById('qaMessages');
        if (messagesContainer) {
            messagesContainer.innerHTML = '<div style="text-align: center; color: #e74c3c; padding: 20px;">Error loading messages</div>';
        }
    }
}

function renderMessages(messages) {
    const messagesContainer = document.getElementById('qaMessages');
    messagesContainer.innerHTML = '';
    
    const mainMessages = [];
    const replies = {};
    
    messages.forEach((data) => {
        if (data.isReply && data.replyTo) {
            if (!replies[data.replyTo]) replies[data.replyTo] = [];
            replies[data.replyTo].push(data);
        } else {
            mainMessages.push(data);
        }
    });
    
    mainMessages.forEach((data) => {
        const messageDiv = createMessageElement(data);
        messagesContainer.appendChild(messageDiv);
        
        if (replies[data.id]) {
            const threadDiv = document.createElement('div');
            threadDiv.className = 'qa-thread';
            
            const threadIndicator = document.createElement('div');
            threadIndicator.className = 'qa-thread-indicator';
            threadIndicator.textContent = `${replies[data.id].length} ${replies[data.id].length === 1 ? 'reply' : 'replies'}`;
            threadDiv.appendChild(threadIndicator);
            
            replies[data.id].forEach(reply => {
                const replyDiv = createMessageElement(reply, true);
                threadDiv.appendChild(replyDiv);
            });
            
            messagesContainer.appendChild(threadDiv);
        }
    });
    
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
}

// Enhanced function to create message elements with better color coding
function createMessageElement(data, isReply = false) {
    const messageDiv = document.createElement('div');
    const currentUserId = localStorage.getItem('meetingUserId');
    const isCurrentUser = data.userId === currentUserId;
    
    // Build class list with proper color coding
    let classList = `qa-message ${isCurrentUser ? 'user' : 'other'} ${data.type}`;
    
    if (data.type === 'question' && data.status === 'answered') {
        classList += ' answered';
    }
    
    messageDiv.className = classList;
    messageDiv.setAttribute('data-message-id', data.id);
    
    // Add click handler for unanswered questions
    if (data.type === 'question' && !isReply && data.status === 'pending') {
        messageDiv.addEventListener('click', () => selectQuestion(data.id, data));
        messageDiv.style.cursor = 'pointer';
        messageDiv.title = 'Click to reply to this question';
    }
    
    const timestamp = data.timestamp ? 
        (data.timestamp.toDate ? new Date(data.timestamp.toDate()).toLocaleTimeString() : new Date(data.timestamp).toLocaleTimeString()) : 
        'Sending...';
    
    // Create type badge with appropriate styling
    const typeBadge = `<span class="qa-message-type">${isReply ? 'reply' : data.type}</span>`;
    
    messageDiv.innerHTML = `
        <div class="qa-message-header">
            <span class="qa-message-user">${data.user}</span>
            <div style="display: flex; gap: 8px; align-items: center;">
                ${typeBadge}
                <span class="qa-message-time">${timestamp}</span>
            </div>
        </div>
        <div class="qa-message-content">${data.text}</div>
    `;
    
    return messageDiv;
}


// Enhanced function to force update all pending counts
function forceUpdateAllPendingCounts() {
    try {
        const sections = [
            'meeting-agenda', 'historical-context', 'erp-integration', 
            'final-release', 'MeetingGoals', 'po-acceptance', 
            'inventory-management', 'production-reporting', 'order-entry', 
            'three-way-match', 'month-end-close', 'Timeline'
        ];
        
        sections.forEach(sectionId => {
            try {
                if (isFirebaseAvailable()) {
                    updatePendingCount(sectionId);
                } else {
                    updatePendingCountLocal(sectionId);
                }
            } catch (error) {
                console.error(`Error updating count for section ${sectionId}:`, error);
            }
        });
    } catch (error) {
        console.error('Error in forceUpdateAllPendingCounts:', error);
    }
}


function updatePendingCount(sectionId) {
    if (isFirebaseAvailable()) {
        db.collection('meeting_qa')
            .where('section', '==', sectionId)
            .where('type', '==', 'question')
            .where('status', '==', 'pending')
            .get()
            .then((querySnapshot) => {
                updateIconBadge(sectionId, querySnapshot.size);
            })
            .catch(() => {
                updatePendingCountLocal(sectionId);
            });
    } else {
        updatePendingCountLocal(sectionId);
    }
}

// Enhanced local storage update function
function updatePendingCountLocal(sectionId) {
    const messages = loadFromLocalStorage(sectionId);
    const count = messages.filter(msg => 
        msg.type === 'question' && 
        msg.status === 'pending' && 
        !msg.isReply
    ).length;
    
    console.log(`Section ${sectionId}: ${count} pending questions`); // Debug log
    updateIconBadge(sectionId, count);
}

// Improved function to update icon badges
function updateIconBadge(sectionId, count) {
    const icon = document.querySelector(`[data-section="${sectionId}"]`);
    if (icon) {
        // Remove existing classes and attributes
        icon.classList.remove('has-pending');
        icon.removeAttribute('data-count');
        
        if (count > 0) {
            // Add the pending class and count
            icon.classList.add('has-pending');
            icon.setAttribute('data-count', count > 99 ? '99+' : count.toString());
            
            // Add a subtle animation to draw attention
            icon.style.animation = 'none';
            setTimeout(() => {
                icon.style.animation = 'iconPulse 2s infinite';
            }, 100);
        } else {
            // Remove animation when no pending questions
            icon.style.animation = 'none';
        }
    }
}

function updateAllPendingCounts() {
    const sections = ['meeting-agenda', 'historical-context', 'erp-integration', 'final-release', 'MeetingGoals', 'po-acceptance', 'inventory-management', 'production-reporting', 'order-entry', 'three-way-match', 'month-end-close', 'Timeline'];
    sections.forEach(sectionId => updatePendingCount(sectionId));
}

function loadQASummary() {
    if (isFirebaseAvailable()) {
        db.collection('meeting_qa')
            .orderBy('timestamp', 'asc')
            .get()
            .then((querySnapshot) => {
                const messages = querySnapshot.docs.map(doc => doc.data());
                renderQASummary(messages);
            })
            .catch((error) => {
                console.error('Error loading Q&A summary:', error);
                loadQASummaryLocal();
            });
    } else {
        loadQASummaryLocal();
    }
}

function loadQASummaryLocal() {
    const allMessages = loadFromLocalStorage();
    renderQASummary(allMessages);
}

function renderQASummary(allMessages) {
    const summaryContainer = document.getElementById('qaSummaryContent');
    
    if (allMessages.length === 0) {
        summaryContainer.innerHTML = '<p style="text-align: center; color: #7f8c8d; font-style: italic;">No questions or notes yet.</p>';
        return;
    }
    
    const sections = {};
    const replies = {};
    
    // Organize messages by section and create replies lookup
    allMessages.forEach((data) => {
        if (!sections[data.section]) sections[data.section] = [];
        sections[data.section].push(data);
        
        if (data.isReply && data.replyTo) {
            if (!replies[data.replyTo]) replies[data.replyTo] = [];
            replies[data.replyTo].push(data);
        }
    });
    
    let html = '';
    const sectionNames = {
        'meeting-agenda': 'Meeting Agenda',
        'historical-context': 'Historical Context',
        'erp-integration': 'Current Architecture',
        'final-release': 'Future Architecture',
        'MeetingGoals': 'Meeting Goals',
        'po-acceptance': 'PO Acceptance Process',
        'inventory-management': 'Inventory Management',
        'production-reporting': 'Production Reporting',
        'order-entry': 'Order Entry & Invoicing',
        'three-way-match': 'Three-Way Match Process',
        'month-end-close': 'Month-End Close Process',
        'Timeline': 'Project Timeline'
    };
    
    // Questions and Answers Section
    let hasQuestions = false;
    Object.keys(sections).forEach(sectionId => {
        const sectionData = sections[sectionId];
        const questions = sectionData.filter(item => item.type === 'question' && !item.isReply);
        
        if (questions.length > 0) {
            if (!hasQuestions) {
                html += '<h3 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-bottom: 20px;">â“ Questions & Answers</h3>';
                hasQuestions = true;
            }
            
            const pendingCount = questions.filter(q => q.status === 'pending').length;
            const answeredCount = questions.filter(q => q.status === 'answered').length;
            
            html += `
                <div class="qa-section-group">
                    <h4>ðŸ“‹ ${sectionNames[sectionId] || sectionId} 
                        <span style="font-size: 12px; color: #7f8c8d;">
                            (${answeredCount} answered, ${pendingCount} pending)
                        </span>
                    </h4>
            `;
            
            questions.forEach((question, index) => {
                const timestamp = question.timestamp ? 
                    (question.timestamp.toDate ? new Date(question.timestamp.toDate()).toLocaleString() : new Date(question.timestamp).toLocaleString()) : 
                    'Unknown time';
                
                const questionId = `question-${sectionId}-${index}`;
                const hasAnswers = replies[question.id] && replies[question.id].length > 0;
                
                html += `
                    <div class="qa-question-item ${question.status === 'answered' ? 'answered' : ''}" style="cursor: ${hasAnswers ? 'pointer' : 'default'};" ${hasAnswers ? `onclick="toggleAnswer('${questionId}')"` : ''}>
                        <div class="qa-question-header">
                            <span class="qa-question-user">ðŸ‘¤ ${question.user}</span>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <span class="qa-question-status ${question.status}">${question.status}</span>
                                <span class="qa-question-time">${timestamp}</span>
                                ${hasAnswers ? '<span style="font-size: 12px; color: #3498db;">â–¼ Click to view answers</span>' : ''}
                            </div>
                        </div>
                        <div class="qa-question-text"><strong>Q:</strong> ${question.text}</div>
                `;
                
                // Add collapsible answers if they exist
                if (hasAnswers) {
                    html += `<div id="${questionId}" class="qa-answers-container" style="display: none; margin-top: 10px; margin-left: 15px; border-left: 3px solid #27ae60; padding-left: 10px; background: #f8f9fa; border-radius: 5px; padding: 10px;">`;
                    
                    replies[question.id].forEach(answer => {
                        const answerTime = answer.timestamp ? 
                            (answer.timestamp.toDate ? new Date(answer.timestamp.toDate()).toLocaleString() : new Date(answer.timestamp).toLocaleString()) : 
                            'Unknown time';
                        html += `
                            <div style="margin-bottom: 8px; padding: 8px; background: white; border-radius: 4px; border-left: 3px solid #27ae60;">
                                <div style="font-size: 11px; color: #27ae60; margin-bottom: 3px; font-weight: bold;">
                                    âœ“ ${answer.user} - ${answerTime}
                                </div>
                                <div style="font-size: 13px; color: #2c3e50;">${answer.text}</div>
                            </div>
                        `;
                    });
                    html += '</div>';
                }
                
                html += '</div>';
            });
            
            html += '</div>';
        }
    });
    
    // Notes Section
    let hasNotes = false;
    Object.keys(sections).forEach(sectionId => {
        const sectionData = sections[sectionId];
        const notes = sectionData.filter(item => item.type === 'note' && !item.isReply);
        
        if (notes.length > 0) {
            if (!hasNotes) {
                html += '<h3 style="color: #2c3e50; border-bottom: 2px solid #2196f3; padding-bottom: 10px; margin: 30px 0 20px 0;">ðŸ“ Notes</h3>';
                hasNotes = true;
            }
            
            html += `
                <div class="qa-section-group">
                    <h4>ðŸ“‹ ${sectionNames[sectionId] || sectionId} 
                        <span style="font-size: 12px; color: #7f8c8d;">
                            (${notes.length} notes)
                        </span>
                    </h4>
            `;
            
            notes.forEach(note => {
                const timestamp = note.timestamp ? 
                    (note.timestamp.toDate ? new Date(note.timestamp.toDate()).toLocaleString() : new Date(note.timestamp).toLocaleString()) : 
                    'Unknown time';
                
                html += `
                    <div class="qa-question-item" style="background: linear-gradient(135deg, #e3f2fd, #f8f9fa); border-left-color: #2196f3;">
                        <div class="qa-question-header">
                            <span class="qa-question-user">ðŸ‘¤ ${note.user}</span>
                            <span class="qa-question-time">${timestamp}</span>
                        </div>
                        <div class="qa-question-text">${note.text}</div>
                    </div>
                `;
            });
            
            html += '</div>';
        }
    });
    
    summaryContainer.innerHTML = html || '<p style="text-align: center; color: #7f8c8d; font-style: italic;">No questions or notes have been added yet.</p>';
}



// Function to toggle answer visibility
function toggleAnswer(questionId) {
    const answerContainer = document.getElementById(questionId);
    const questionItem = answerContainer.parentElement;
    const indicator = questionItem.querySelector('.qa-question-header span:last-child');
    
    if (answerContainer.style.display === 'none') {
        answerContainer.style.display = 'block';
        indicator.innerHTML = 'â–² Click to hide answers';
        indicator.style.color = '#27ae60';
    } else {
        answerContainer.style.display = 'none';
        indicator.innerHTML = 'â–¼ Click to view answers';
        indicator.style.color = '#3498db';
    }
}



// Setup periodic updates with error handling
setInterval(() => {
    try {
        forceUpdateAllPendingCounts();
    } catch (error) {
        console.error('Error in periodic update:', error);
    }
}, 20000); // Update every 20 seconds

window.onclick = function(event) {
    const modal = document.getElementById('qaModal');
    if (event.target === modal) {
        closeQAModal();
    }
}




    </script>
</body>
</html>